<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2020">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Installing the redBorder Enterprise Edition IPS</title>
    <section>
		<title>What is an IDS?</title>
		<para><emphasis role="bold">IDS</emphasis> is an Intrusion Detection System in the network to protect one organization.</para> 
		<para>It is a specific software that runs in user space and analyse network traffic (using a mirror port or SPAN) in one system interface or between two interfaces joined as a bridge (software switch).</para>
		<para>The traffic is analyzed for anomalies, specific signatures or suspicious behaviors.</para> 
		<para>The goal of an IDS is <emphasis role="bold">to dectect intrusions and create alerts without interrupting the traffic in the organization.</emphasis></para>
    </section>
    <section>
		<title>What is an IPS?</title>
		<para><emphasis role="bold">IPS</emphasis> is an Intrusion Prevention System that works in the network or networks inside an organization.</para> 
		<para>It works in the same way as an IDS (in fact it normaly uses the same software with an adapted behavior), in this case an IPS can block the traffic in the organization,
		 in that way when an attack is detected the system can choose between 
		 <emphasis role="bold">showing alerts or discard those packets, working in a similar way as a firewall.</emphasis></para>
		 <para>The configuration and registration of the IPS/IDS sensors into the Manager is the next step to the installation one. This process consist in two steps:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Installation and registration of the IPS/IDS sensors in the Manager</para>							
			</listitem>	
			<listitem>
				<para>Configuration of basic parameters in the redborder platform</para>
			</listitem>
		</itemizedlist>
	</section>
	<section>
	    <title> Requirements</title>
	    <para> <emphasis role = "bold"> redBorder IPS</emphasis> is a software that needs the following requirements in order to function correctly. The minimum essential elements required for the installation as well as those recommended for correct performance are referenced at every SNORT instance being executed. They are shown in the following table:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "350" fileref ="images/ch01_img001.png"/>
            </imageobject>
            <textobject>
				<phrase> Figure 1: Requirements for installing redBorder IPS</phrase>
            </textobject>
            <caption>
                <para> Figure 1: Requirements for installing redBorder IPS </para>
            </caption>
        </mediaobject>
		<para> For example, if you want four SNORT instances in the recommended configuration, you need a machine with 16 GB and four cores.</para>
                <warning>
                  <title> Warning </title>
                  <para> It is VERY IMPORTANT that the configuration of the Manager (or cluster of managers) is performed before configuring IPS sensors. </para>
                  <para> The Manager must be operational and in a network accessible to the sensors. Some of the sensor configuration processes depend on the access to the Manager. </para>
                </warning>
	</section>	
	<section>
		<title>Obtaining the ISO</title>
		<para> Redborder Enterprise Edition IPS is distributed as an ISO file that can be obtained in different ways. If you don’t have it, please contact our sales team (sales@redborder.com) or our support team (support@redborder.com) to provide you with the last available ISO file or a way to download it.</para>
	</section>	
	<section>
		<title>Burning the ISO Image</title>
		<para> The ISO image is prepared to perform the boot from a DVD reader, USB device or as an ISO file for a virtual machine.</para>
		<para><emphasis role = "bold">NOTE: The process of creating a bootable USB for the IPS installation is the same as for the manager installation. You can find it accessing the support page.</emphasis></para>
		<para>In order to burn the ISO image from a Linux system to a USB device, the following command needs to be used if the USB device is mapped in /dev/sdd:</para>
		<programlisting>[root@machine ~]# dd if=redBorder-3.1.80-18-x86_64-6.5-sensor.iso of=/dev/sdd bs=10M</programlisting>
	</section>	
	<section>
		<title>Installing the ISO</title>
		<para><emphasis role = "bold">NOTE: If a usb memory is used on a real machine, the operating system will be automatically extending the disk and the data on the usb will be lost. To avoid this, the usb needs to be removed before rebooting.</emphasis></para>
		<para>Once you have booted the redborder ISO, you will see the installation menu. To perform the installation, select the option: Install Sensor IPS:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img002.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 2: Installation process</phrase>
            </textobject>
            <caption>
                <para>Figure 2: Installation process</para>
            </caption>
        </mediaobject>
		<para>Once in the installation process, the user only needs to confirm the installation destination and root password. Redborder is prepared for unattended installations and so you should be especially careful with the time you have to respond to these three questions if you wish to modify the default options:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img003.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 3: Installation process</phrase>
            </textobject>
            <caption>
                <para>Figure 3: Installation process</para>
            </caption>
        </mediaobject>
		<para>Once this page has been confirmed, the installation will carry out all of the necessary processes to prepare the system for configuration.</para>
		<para>By default, the root password will be <emphasis role = "bold">redborder</emphasis>.</para>
	</section>	
	<section>
		<title>Basic Configuration</title>
		<para>Upon completing the installation process, you have two configuration options depending on whether or not there is a DHCP server.</para>
		<itemizedlist mark = "bullet">
			<listitem>
				<para>Dynamic IP (DHCP): in this case, redBorder will have acquired an IP in its network interface.</para>
			</listitem>
			<listitem>
				<para>Static IP: in this case redborder will not have any IP assigned.</para>
			</listitem>
		</itemizedlist>
		<para>In both cases you will have to access the system in order to configure and register the sensor in the manager. You will access with the root user and password that was selected during installation.</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img004.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 4: Basic Configuration</phrase>
            </textobject>
            <caption>
                <para>Figure 4: Basic Configuration</para>
            </caption>
        </mediaobject>
		<para>Once inside the system you will start the configuration manager. To do this, you will execute:</para>
		<programlisting>[root@rbmanager ~]# rb_sysconf</programlisting>
		<para>A menu with different options will appear:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img005.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 5: Basic Configuration</phrase>
            </textobject>
            <caption>
                <para>Figure 5: Basic Configuration</para>
            </caption>
        </mediaobject>
        <para>Once execute <literal>rb_sysconf</literal> you will access the <emphasis role="bold">redborder configuration menu</emphasis>.</para>
		<para>There are 5 options:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para><literal>System Configuration:</literal> here you can define and modify basic settings such as hostname, date, time, etc.</para>
			</listitem>
			<listitem>
				<para><literal>Network Configuration:</literal> this is the option where you can configure the network settings.</para>
			</listitem>
			<listitem>
				<para><literal>Passwords:</literal> access this option if you need to change your credentials.</para>
			</listitem>
			<listitem>
				<para><literal>Update rules from Manager:</literal> select this option to force a rule update from the Manager (optional).</para>
			</listitem>
			<listitem>
				<para><literal>quit:</literal> exit.</para>
			</listitem>
		</orderedlist>
		<section>
		<title>Network configuration</title>
		<para>IDS/IPS sensors need to comunicate with the el Manager, to make this possible some network configuration is needed. Select option <literal>2) Network Configuration</literal> from the redborder configuration menu.</para>
		<para>Until this setting is not made properly, the sensor will not be able to be registered in the Manager.</para>
		<para>Those are the steps you need to follow to network configure your sensor:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para>Managagement network configuration:</para>
				<para>a) Make a bonding and assign management interface.</para>
				<para>b) Segments configuration.</para>	
			</listitem>
			<listitem>
				<para>Doman and DNS configuration</para>
			</listitem>
		</orderedlist>
		<note>
			<title>Note</title>
			<para>The order to configure the management network can be different. The order described on this manual is considered to be the more optimal one.</para>
		</note>
		<warning>
			<title>Warning</title>
			<para>In case the system is install in a machine with multiples network interfaces, the user need to select the one that will be the management bonding.</para>
		</warning>
	</section>
	<section>
		<title>Interface asignement and bonding creation</title>
		<para>Select <literal>Network Configuration</literal> typing option <keycap>2</keycap> y press <keycap>Enter.</keycap></para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img016.png"/>
			</imageobject>
		<caption>
			<para>Automatic bypass segmenet detection</para>
		</caption>
		</mediaobject>
		<para>In case the system detect <emphasis>bypass</emphasis> interfaces, the will be added automaticaly as segments.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img017.png"/>
			</imageobject>
			<caption>
				<para>Network sensors configuration</para>
			</caption>
		</mediaobject>
		<para>To configure the network configuration correclty:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Bonding creation: (4 bonds max).</para>
			</listitem>
			<listitem>
				<para>Selection and assigment of bonding ports.</para>
			</listitem>
			<listitem>
				<para>Managmenet network interfaces selections for the bondings.</para>
			</listitem>
		</itemizedlist>
		<para>The system will show a detailled list that will help the administrator to decide which ports are available to bonding creation.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img018.png"/>
			</imageobject>
			<textobject>
				<phrase>Insert bonding port</phrase>
			</textobject>
			<caption>
				<para>Insertar bonding port</para>
			</caption>
		</mediaobject>
		<note>
			<title>Note</title>
			<para>To select the default parameters press: <keycap>Enter</keycap></para>
		</note>
		<section>
			<title>Creation of a new bonding and port assignments</title>
			<para>To show t his process we will create a bonding (bond0) with 2 ports.</para>
			<para>Select option <keycap>n</keycap> from the right lateral submenu.</para>
			<para>All available ports will be shown, select the one that you want to be part of the bonding.</para>
			<para>Introduce port number in <literal>Insert bonding first port [0]:</literal></para>
			<para>The number between the brackets <literal>[]</literal> is the one that the system defined by default. To selectt this number press <keycap>Enter.</keycap></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img019.png"/>
				</imageobject>
				<textobject>
					<phrase>Bonding creation: port assignments</phrase>
				</textobject>
				<caption>
					<para>Bonding creation: port assignments</para>
				</caption>
			</mediaobject>
			<para>The selected port will disappear from the list of available ports.</para>
			<important>
				<title>Important</title>
				<para>The system only allows a maximum of 4 bonds: (0-3).</para>
			</important>
		</section>
		<section>
			<title>Add an extra bonding port</title>
			<para>The sytem will ask: <literal>Insert second port (y/N)</literal></para>
			<para>The default option is the opne with uppercase. Remember that if you dont need to add a new port you only need to press <keycap>Enter</keycap>.</para>
			<para>In case you want to add an extra port press <keycap>y</keycap>.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img020.png"/>
				</imageobject>
			<textobject>
				<phrase>Add new port to the bonding</phrase>
			</textobject>
			<caption>
				<para>Add new port to the bonding</para>
			</caption>
			</mediaobject>
			<para>Insert the port number <literal>Insert bonding second port [1]:</literal></para>
			<para>The number between brackets <literal>[]</literal> is the default setting. To select this number just press <keycap>Enter</keycap>.</para>			
		</section>
		<section>
			<title>Bonding network configuration</title>
			<para>Once the assigment of the second port is made on the new bonding (bond0), the system will ask the following:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>IP Address</para>
				</listitem>
				<listitem>
					<para>Network mask</para>
				</listitem>
				<listitem>
					<para>Gateway</para>
				</listitem>
				<listitem>
					<para>Routes</para>
				</listitem>
			</itemizedlist>
			<para>If your device uses DHCP, an IP address will be assign by default. Press <keycap>Enter</keycap> to select the IP, network mask and gateway assign by the system.  In other case, enter manually those values.</para>
			<para>The system also add default routes for the new bonding.</para>
			<para>To insert a manual route, select option <keycap>y</keycap> in <literal>Insert a route for this bonding (y/N)?:</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img021.png"/>
				</imageobject>
				<caption>
				<para>Add a manual route to the bonding</para>
			</caption>
			</mediaobject>
			<para>Once this process is finish, a message will appear: <literal>Bonding 0 created successfully.</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img022.png"/>
				</imageobject>
			</mediaobject>
		</section>
		<section>
			<title>Finish bonding creation process</title>
			<para>Befor apply the changes and finish the bonding creation process the system will show a table with the new bonding (bond0) next to the used ports, IP, network mask and routes.</para>	
			<para><emphasis role="bold">Apply changes</emphasis></para>
			<para>To save the setings, you should apply the changes selection the option <keycap>a.</keycap></para>
			<para>You can delte in any moment the bond or bonds made selecting option <literal>delete bonding</literal> pressing the key <keycap>d.</keycap></para>
			<para>To go back to the main menu, select option <literal>quit</literal> pressing <keycap>q.</keycap></para>
		</section>
	</section>
	<section>
		<title>Domain and DNS configuration</title>
		<para>On the network menu configuration we can find this option <literal>DNS and domain settings.</literal> To start the process, select option<keycap>2.</keycap></para>
		<para>In order to configure this correctly the user will need to introduce:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Domain name</para>
			</listitem>
			<listitem>
				<para>Primary DNS address</para>
			</listitem>
			<listitem>
				<para>Secondary DNS address (opcional)</para>
			</listitem>
		</itemizedlist>
		<para>Once the values are set, the system will show a message telling the configuration was made successfully.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img023.png"/>
			</imageobject>
		<caption>
			<para>Domain and DNS configuration</para>
		</caption>
		</mediaobject>
		<para>To end this process, no apply changes is needed, select option <literal>quit</literal> pressing <keycap>q</keycap> to go back to the main network menu.</para>
	</section>
	<section>
		<title>Segments configuration</title>
		<para>Select option <literal>Segment settings</literal> pressing the number <keycap>3</keycap>.</para>
		<para>This screen will show the current number of segments, ports of each segment and if they support bypass.</para>
		<para>On this section you will find the folling submenu:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para><keycap>f)</keycap> <literal>force bypass autoassign:</literal>to foce automaticaly bypass port assigment.</para>
			</listitem>
			<listitem>
				<para><keycap>n)</keycap> <literal>new segment:</literal>selection this option to make a new segment.</para>
			</listitem>
			<listitem>
				<para><keycap>d)</keycap> <literal>delete segment:</literal>to delete one segment.</para>
			</listitem>
			<listitem>
				<para><keycap>q)</keycap> <literal>quit:</literal>exit.</para>
			</listitem>
		</itemizedlist>
		<para>To make a new segmenet select <literal>n) new segment.</literal></para>
		<para>This process include the following actions:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para>Assigment of bypass interfaces to the segments (opcional).</para>
			</listitem>
			<listitem>
				<para>Creation of one segmenet: (max 16 segments).</para>
			</listitem>
			<listitem>
				<para>Select and assign ports to a segment.</para>
			</listitem>
		</orderedlist>
		<para> In order to select a port, a detaill list will be shown, this will help the adminsitator to decided which ports will be use by the segments.</para>
		<section>
			<title>Bypass interfaces selection</title>
			<para>When the system detects bypass interfaces, it will be added automacticaly after access the network configuration menu.</para>
			<para>There are also two extra ways assign a port:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold"> Force bypass autoassign:</emphasis> sellect option <literal>Force bypass auto assign</literal> on the segment configuration menu pressing <keycap>f</keycap>.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Manual assigment:</emphasis> select bypass ports from the list of available ports.</para>				
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img024.png"/>
				</imageobject>
			<caption>
				<para>Assign ports to a segment</para>
		    </caption>
			</mediaobject>
		</section>
		<section>
			<title>Creation of a new segment</title>
			<para>As an example we are gonna make a segment (segment 0) and will be assign 2 ports.</para>
			<para> To begin the process select option <keycap>n</keycap> that appears in the right submenu.</para>
			<para>Once you have check all available ports, select the one that you wan to include in the segment.</para>
			<para>Introduce the segment number on <literal>Insert segment number (0-15) [0]:</literal></para>
			<para>Th number between brackets <literal>[]</literal> is the default one. To select this number just press <keycap>Enter</keycap>.</para>
		    <para>The previous assig port will disappear from the list of available ports.</para>
		    <note>
				<title>Note</title>
				<para>The system only allow a maximum of 16 segments (0-15).</para>
		    </note>
		</section>
		<section>
			<title>Add a second port to the segment</title>
			<para>Once assign the first port to the segment, the system will ask for a second one: <literal>Assign second port to the segment (Y/n):</literal></para>
			<para>By default the option is the one in uppercase.</para>
			<para>Remember if you want to assign a new port you only need to press <keycap>Enter</keycap>.</para>
			<para>In another case just press <keycap>n</keycap>. Select an available port from the list.</para>
			<para>Enter the number of the port on <literal>Insert segment second port [3]:</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img025.png"/>
				</imageobject>
			<caption>
				<para>Assign new port to the segment</para>
			</caption>
		    </mediaobject>
			<para>Once the ports were assign to a segment, the system will show a message: <literal>Segment 0 created successfully.</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img026.png"/>
				</imageobject>
			<caption>
				<para>Confirmation of segment creation</para>
			</caption>
			</mediaobject>
		</section>
		<section>
			<title>Finish the segment creation process</title>
			<para>Before applying the changes and finish the process, the system will show the settings:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>Segments</para>
				</listitem>
				<listitem>
					<para>Assigned ports</para>
				</listitem>
				<listitem>
					<para>Bypass support</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img027.png"/>
				</imageobject>
			<caption>
				<para>Assigned ports</para>
			</caption>
			</mediaobject>		
			<para><emphasis role="bold">Apply changes</emphasis></para>
			<para>To save the settings press <keycap>a.</keycap></para>
			<para>You can delete in any moment the created segments by selection <literal>delete segment</literal>, pressing  <keycap>d</keycap>.</para>
			<para>To go back to the main network configuration menu select <literal>quit</literal> by pressing <keycap>q</keycap>.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img028.png"/>
				</imageobject>
			<caption>
				<para>Segments overview</para>
			</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img029.png"/>
				</imageobject>
			<caption>
				<para>Apply changes to finish segment creation process</para>
			</caption>
			</mediaobject>		
		</section>
	</section>
	<section>
		<title>Manager sensor registration</title>
		<para>To finish the installation process of the IPS/IDS sensors the last step consist in <emphasis role="bold">Manager sensors registration.</emphasis></para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img030.png"/>
			</imageobject>
			<caption>
				<para>Start of sensor registation process</para>
			</caption>
	    </mediaobject>	
		<para>In the sensor registration menu we can find the following options:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para><literal>Hostname [rbsensor]:</literal> assign a sensor name.</para>
			</listitem>
			<listitem>
				<para><literal>Set local time:</literal> configure local time.</para>
			</listitem>
			<listitem>
				<para><literal>IP adress for rB Master Manager [127.0.0.1]:</literal> introduce the Manager IP.</para>
			</listitem>
			<listitem>
				<para><literal>Register rB:</literal> register the sensor into the Manager.</para>
			</listitem>
		</orderedlist>
		<section>
			<title>Assign sensor name (Hostname)</title>
			<para> Select the option <literal>Hostname [rbsensor]</literal> from the registration menu pressing <keycap>1</keycap>.</para>
			<para> Next, on the line <literal>Insert Hostname [rbsensor]:</literal> type the name you which for your sensor. This name will be appear in the the web on the sensor list.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img031.png"/>
				</imageobject>
			<caption>
				<para>Assign sensor name</para>
			</caption>
			</mediaobject>
			<note>
				<title>Note</title>
				<para>Remember to introduce a good name. Avoid to use generic names like “Sensor”.</para>
			</note>
			<warning>
				<title>Warning</title>
				<para>The system will ask you to  verify the sensor name, in that case press <keycap>Enter</keycap></para>
				<para>If you want to make a modification press <keycap>n</keycap></para>
				<para>The system will change the sensor name. To continue and go back the to the main systm menu press any key  <literal>Press a key to continue...</literal></para>
			</warning>	
		</section>		
		<section>
			<title>Local time configuration</title>
			<para>Seleccionar la opción <literal>2) Set local time.</literal></para>
			<para>Insertar fecha y hora de la franja horaria correspondiente al país en el que se encuentre. Esta debería coincidir con la seleccionada en la fase de ajustes básicos durante el proceso de configuración de los sensores IPS. </para>
			<para> El sistema le indica dos formatos posibles para la inserción de la fecha y la hora:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><literal>[HH:mm]</literal> ó <literal>[YYYY/MM/DD]</literal></para>
				</listitem>
				<listitem>
					<para><literal> [YYYY/MM/DD HH:mm]</literal></para>
				</listitem>
			</itemizedlist>
			<para>Pulsar <keycap>Enter</keycap> para continuar con el proceso de registro.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img024.png"/>
			    </imageobject>
			   <caption>
				<para>Registro de los sensores en el Manager: Selección hora local</para>
			</caption>
		    </mediaobject>
		</section>
		<section>
			<title>Introducir la IP del Master Manager</title>
			<para>Seleccionar la opción <literal>3) IP adress for rB Master Manager [.*].</literal></para>
			<para>Insertar la dirección IP o nombre de dominio del equipo utilizado por el usuario. El sistema realizará una serie de comprobaciones para verificar si es alcanzable. Este proceso puede llevar unos segundos.</para>
			<para>El sistema sincronizará la hora de los equipos y a continuación, reiniciará un par de servicios con el objetivo de finalizar la sincronía horaria.</para>
			<para> ¡Enhorabuena! Su equipo está preparado para realizar el registro de los sensores en el Manager.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img025.png"/>
			    </imageobject>
			   <caption>
				<para>Insertar IP master Manager</para>
			</caption>
		    </mediaobject>
		    <para>Para continuar, y regeresar al menú de configuración del sistema redborder, pulse cualquier tecla tal y como se indica <literal>Press a key to continue...</literal></para>
		</section>
		<section>
			<title>Registro de los sensores en el Manager</title>
			<para>Este es el último paso que da por finalizado el proceso de implantación de la solución redborder IPS.</para>
			<para> A partir de este momento, usted podrá trabajar directamente desde la aplicación de gestión IPS, en cuyo dashboard visualizará de manera gráfica todos los eventos de tráfico captados por los sensores IPS. </para>
			<para>En esta aplicación podrá crear informes, visualizar los eventos o configurar las reglas del Manager entre otras acciones. </para>
			<para><emphasis>Finalización del proceso del registro de los sensores en el Manager</emphasis></para>
			<para> Los pasos que se van a seguir para completar el proceso de registro de los sensores en el Manager son los siguientes:</para>
			<orderedlist numeration="arabic">
				<listitem>
					<para> Indicar si se desea tener una salida de depuración: el sistema formulará la siguiente pregunta <literal>Would you like to have a debug output?</literal> Seleccionar la opción predeterminada (No) insertando la letra <keycap>N</keycap>.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Insertar password:</emphasis> indicar la clave que se ha introducido en la fase de ajustes básicos para la configuración del Manager.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold"> Sincronización temporal (automático) entre el Manager y los sensores:</emphasis> este proceso puede llevar unos segundos en completarse.</para>
		        </listitem>
		     </orderedlist>
		     <mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img026.png"/>
				</imageobject>
			<caption>
				<para>Finalización del registro de los sensores en el Manager</para>
			</caption>
			</mediaobject>
				<para>Tras la realización de estos pasos, el sistema le avisará con un mensaje de que el sensor ha sido registrado con éxito.</para>
				<para><literal> Sensor registered succesfully with chef server</literal></para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img028.png"/>
			        </imageobject>
			    <caption>
					<para>Registro del sensor en el servidor</para>
				</caption>
		    </mediaobject>
			<warning>
				<title>Advertencia</title>
				<para>No cambiar el nombre del sensor o <emphasis>hostname</emphasis> una vez que ha sido registrado. Si desea realizar cambios, será necesario deshacer todo el proceso de registro y comenzarlo de nuevo.</para>
			</warning>
			<para>Para continuar y regresar al menú de configuración del sistema redborder, pulse cualquier tecla tal y como se indica <literal>Press a key to continue...</literal></para>
			<para>En él menú de registro de los sensores en el Manager redborder puede comprobar que el sensor ha sido registrado con éxito:<literal>(Registered).</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img029.png"/>
			    </imageobject>
			    <caption>
					<para>Registro del sensor realizado con éxito</para>
				</caption>
		    </mediaobject>
		    <para> Para salir del asistente de registro de los sensores en el Manager, seleccione la opción <literal>quit</literal> introduciendo la letra <keycap>q.</keycap></para>				
		</section>
	</section>
	<section>
	<title>Edición y configuración de los sensores IPS/IDS</title>
	<para> Para realizar la configuración de los sensores IPS/IDS es necesario acceder a la plataforma web de redborder insertando la IP de gestión asignada al Manager en la barra de direcciones de su navegador.</para>
	<para><screen>https://direccion-IP-manager</screen></para>
	<note>
		<title>Nota</title>
		<para>Es posible iniciar sesión en la plataforma usando la cuenta definida por defecto: <emphasis role="bold">admin o admin@redborder.com</emphasis>
		 y con la contraseña que haya insertado en el proceso de instalación del Manager.</para>
	</note>
	<warning>
		<title>Advertencia</title>
		<para>La web de gestión no funcionará si se intenta acceder a ella mediante web no cifrada.</para>
	</warning>
	<para>Existen tres modos de acceder a la edición de los sensores IPS/IDS para la configuración de sus parámetros de funcionamiento:</para>
	<itemizedlist mark="bullet">
		<listitem>
			<para><emphasis role="bold">Vista árbol:</emphasis> en la vista árbol el usuario puede ver los sensores IPS/IDS que se han creado acompañados de un icono identificativo. 
			Para acceder a su edición hacer clic sobre el nombre del sensor o bien, en el icono "Editar" -> <literal>"Edit"</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img030.png"/>
				</imageobject>
				<caption>
					<para>Vista árbol: editar sensor IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
		<listitem>
			<para><emphasis role="bold">Vista Access Points:</emphasis> la vista de Access Points muestra un listado con los puntos de acceso a la red que se han definido. 
			Haciendo clic sobre un Access Point se accede a la interfaz de configuración de los parámetros generales del sensor. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="150" fileref="images/ch04_img031.png"/>
				</imageobject>
				<caption>
					<para>Vista Access Points: editar sensor IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
		<listitem>
			<para><emphasis role="bold">Vista específica de IPS:</emphasis> en la opción <literal>View</literal> se encuentran vistas específicas para cada tipo de sensor.
			Seleccionar <literal>IPS sensors</literal> para acceder al listado alfabético de los sensores IPS. Hacer clic en el icono "Editar".</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img032.png"/>
				</imageobject>
				<caption>
					<para>Vista IPS Sensors: IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
	</itemizedlist>
		<section>
		<title>Editar la configuración del sensor IPS/IDS</title>
			<para>En todos los casos descritos el usuario accede a una pantalla en la que puede realizar la configuración de los parámetros básicos de los sensores IPS/IDS. </para>
			<para>Los campos del formulario de configuración varían según se esté editando un sensor, grupo de segmentos o binding.
			Este paso es muy importante puesto que una configuración u otra determinará el modo de funcionamiento del sensor según se instale en un escenario u otro (IPS o Malware). 
			Estas opciones se definen en el apartado <emphasis role="bold">Configuración IPS/IDS.</emphasis></para>
			<para>A continuación se enumeran los campos que se muestran en el formulario de configuración de un sensor IPS:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>General: muestra información general del sensor. La única información editable en este apartado es la descripción. 
					<footnote><para>Tanto la IP como el nombre del sensor han sido definidos durante el proceso de instalación y registro de los sensores en el Manager.</para></footnote></para>
				</listitem>
				<listitem>
					<para>Configuración IPS/IDS (IPS/IDS Settings)</para>
				</listitem>
				<listitem>
					<para>Servidores (Servers)</para>
				</listitem>
				<listitem>
					<para>Trap servers</para>
				</listitem>
				<listitem>
					<para>Segmentos (Segments)</para>
				</listitem>
				<listitem>
					<para>Network routes</para>
				</listitem>
				<listitem>
					<para>Localización (Location)</para>
				</listitem>
				<listitem>
					<para>IP Variables</para>
				</listitem>
				<listitem>
					<para>Variables de puertos (Port variables)</para>
				</listitem>
				<listitem>
					<para>Grupos (Groups)</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img033.png"/>
				</imageobject>
				<caption>
					<para>Información editable para la configuración de los sensores IDS/IPS</para>
				</caption>
			</mediaobject>
			<para>En el margen superior derecho de la pantalla encontramos las siguientes opciones:</para> 
			<itemizedlist mark="bullet">
				<listitem>
					<para><literal>Stop Auto-apply</literal></para>
					<para>Este botón evita que Chef aplique de manera automática los cambios (que refresca y aplica cada 5 minutos).</para>
					<para>El sistema abrirá una ventana de confirmación para asegurarse de que esta es la acción que desea realizar el usuario.</para>
				</listitem>
				<listitem>
					<para><literal>Options-> Recreate Private Key</literal></para>
					<para>Esta opción regenera la clave privada de sincronización del sensor IPS con el Manager. Si tiene rol de Administrador en redborder, 
					encontrará también esta opción en la interfaz de edición de usuarios en <literal>Tools -> Users</literal>.</para>
					<para>Una vez que se haya confirmado dicha restauración, el usuario deberá introducir el texto que se le muestra en la ventana modal en el IPS siguiendo la siguiente ruta: 
					<computeroutput>/etc/chef/client.pem</computeroutput></para>
				</listitem>
			</itemizedlist>
			<warning>
				<title>Advertencia</title>
				<para><emphasis role="bold">La acción de restauración de la clave privada es muy sensible puesto que puede dejar sin comunicación al sensor con el Manager.</emphasis> Por ello, el sistema abre una ventana de confirmación antes de realizar cualquier acción. 
					Asegúrese que está seguro de que desea realizar la restauración de la clave de seguridad antes de proceder a su confirmación. </para>
			</warning>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="150" fileref="images/ch04_img034.png"/>
				</imageobject>
				<caption>
					<para>Opciones del submenú de sensores IPS/IDS: Stop Auto-apply y Recreate Private Key</para>
				</caption>
			</mediaobject>
		</section>	
		<section>
			<title>IPS/IDS Settings</title>
			<para>En este apartado encontramos las opciones disponibles para configurar los sensores IPS/IDS y el comportamiento de Snort y PF_RING.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img035.png"/>
				</imageobject>
				<caption>
					<para>Campos editables para la configuración IPS/IDS (IPS Settings)</para>
				</caption>
			</mediaobject>
			<para><literal>Sensor mode</literal></para>
			<para>Modo predeterminado del sensor <literal>Default sensor mode</literal>: en esta casilla aparecerá el modo que se haya heredado de niveles superiores.
			En este caso aparecerá la palabra INHERITED seguida, entre paréntesis, del modo que ha sido heredado.</para>
			<para>En este campo, el usuario podrá elegir entre 4 opciones diferentes:</para>		
			<orderedlist>
				<listitem>
					<para><emphasis role="bold">IDS forwarding:</emphasis> el tráfico es desviado de manera inmediata por el sensor; a continuación, una copia del mismo es analizada.
					En la práctica, produce el mismo efecto que tener un TAP interpuesto antes del sensor.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">IDS span:</emphasis> únicamente se analiza el tráfico. No se realiza ningún desvío.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">IPS test mode:</emphasis> el tráfico es analizado y, posteriormente, desviado. Este modo es el recomendado para realizar simulaciones de bloqueo de tráfico atacante.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">IPS:</emphasis> esta es la opción más común en entornos de producción. 
					Snort analiza el tráfico y deja pasar o bloquea el tráfico dependiendo de las acciones establecidas para las reglas incluidas en la política activa del sensor.</para>
				</listitem>			
			</orderedlist>
			<important>
				<title>Importante</title>
				<para>El sensor debe estar configurado en <emphasis role="bold">modo IPS Test mode o IPS </emphasis> para el escenario básico de la instalación de redborder IPS.</para>
			</important>
			<para>A continuación, el usuario puede editar una serie de parámetros relacionados con el comportamiento de PF_RING y Snort:</para>
			<para><literal>PF_RING Watermark</literal></para>
			<para>Indica el número mínimo de paquetes entrantes para la función poll.</para>
			<itemizedlist mark="bullet">	
				<listitem>		
					<para><emphasis>Valor bajo de watermark (1):</emphasis> reduce la latencia de la función poll, disminuye el throughtput, pero puede incrementar el número de llamadas a la función poll.</para>
				</listitem>
				<listitem>	
					<para><emphasis>Valor alto de watermark</emphasis> (nunca debe exceder del 50% del tamaño del anillo o de lo contrario el módulo kernel de PF_RING aumentará este valor): reduce el número de llamadas poll,
				pero aumenta ligeramente la latencia de paquete.</para>
				</listitem>
			</itemizedlist>
			<para><literal>PF_RING Clustermode</literal></para>
			<para>Divide el tráfico entrante en varios anillos. Especialmente indicado para <emphasis role="bold"> distribuir la carga</emphasis> 
			al posibilitar que una misma interfaz sea leída desde varios programas de Snort.</para>
			<para>Indica el número de parámetros usados para determinar el hash y el balanceo del tráfico entre los diferentes procesos Snort. 
			Dependiendo del número elementos que se agregan a la tupla el tráfico se distribuirá de una forma distinta:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>2 tuple flow: IP de origen+IP de destino</para>
				</listitem>
				<listitem>
					<para>4 tuple flow: IP de origen:Puerto_src+IP de destino:Puerto_dst</para>
				</listitem>
				<listitem>
					<para>5 tuple flow: IP de origen:Puerto_src+IP de destino:Puerto_dst+protocolo</para>
				</listitem>
				<listitem>
					<para>6 tuple flow: IP de origen:Puerto_src+IP de destino:Puerto_dst+protocolo+Vlan</para>
				</listitem>
			</itemizedlist>
			<para><literal>Bypass controlled by Snort</literal></para>
			<para>Cuando la máquina arranca Snort puede tomar el control de los bypass automáticamente.
			Esta acción puede provocar un flapping indeseado del firewall para evitar que Snort esté habilitado para el control de los bypass.</para>
			<para><literal>Threshold Count</literal></para>
			<para>Número máximo de ocurrencias en un rango de tiempo determinado para que un evento sea enviado.</para>
			<para><literal>Threshold Seconds</literal></para>
			<para>Tiempo mínimo (en segundos) que tiene que pasar para que un evento sea enviado.</para>
			<note>
				<title>Nota</title>
				<para>En escenarios donde existe una sobrecarga en el tráfico es posible realizar una configuración que permita mantener la conectividad por encima del análisis de los paquetes.</para>
				<para>Las opciones de <literal>Best effort Configuration</literal> y <literal>Software Bypass Configuration</literal> se utilizan para priorizar el reenvío de información sobre el análisis de la misma.</para>
			</note>
			<para><literal>Best effort Configuration</literal></para>
			<para>Esta configuración solo aplica en el modo <emphasis role="bold">IDS.</emphasis></para>
			<para>Al habilitar esta opción, el tráfico es copiado en una cola interna de trabajo y posteriormente, desviado. 
			Solo en el caso de que no existan más paquetes que desviar, se procesarán los paquetes que se encuentran en la cola interna. 
			Si la cola interna se encontrase llena, los paquetes no serán analizados. Esto aumenta la fiabilidad del desvío, pero disminuye el rendimiento del análisis. </para>
			<para><literal>Software Bypass Configuration</literal></para>
			<para>Esta configuración solo aplica en el modo <emphasis role="bold">IPS.</emphasis></para>
			<para>La activación de esta opción implica que, si la ocupación del anillo de la interfaz es alta, 
			el IPS desviará los paquetes sin analizar hasta que la ocupación se encuentre por debajo de otro valor predeterminado.</para>
			<important>
				<title>Importante</title>
				<para>La configuración del bypass de IPS se realiza a nivel de software. Para determinar la configuración de los bypass a nivel de hardware, consultar el apartado <literal>Segments.</literal></para>			
			</important>
		</section>	
		<section>
			<title>Servidores</title>
			<para>En este apartado el usuario puede definir la configuración de los servidores Proxy y Syslog.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img036.png"/>
				</imageobject>
				<caption>
					<para>Configuración servidores Proxy y Syslog</para>
				</caption>
			</mediaobject>
			<para>Este apartado mostrará todos sus campos con la configuración heredadas por el sensor. El usuario podrá editar la siguiente información: </para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>Syslog Servers</para>
				</listitem>
				<listitem>
					<para>Syslog protocol: UDP/TCP</para>
				</listitem>
				<listitem>
					<para>syslog mode: Basic/Extended</para>
				</listitem>
				<listitem>						
					<para>Enable proxy: Yes/No</para>
				</listitem>
			</itemizedlist>
		</section>
		<section>
			<title>Trap Servers</title>
			<para>En este apartado se realiza la configuración del SNMP de los <literal>Trap Servers</literal> .</para> 
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img037.png"/>
				</imageobject>
				<caption>
					<para>Listado de Trap Servers</para>
				</caption>
			</mediaobject>
			<para><emphasis role="bold">Añadir Trap Server:</emphasis> Es posible añadir un nuevo <literal>Trap Server</literal> haciendo clic en <literal>+Add.</literal>
			A continuación, introducir la IP y la Comunidad SNMP a la que pertenece. <literal>Update</literal> para guardar los cambios introducidos.</para>		
			<para><emphasis role="bold">Eliminar Trap Server:</emphasis> Pulsar en el icono "Eliminar" para descartar el Trap Server seleccionado.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img038.png"/>
				</imageobject>
				<caption>
					<para>Añadir nuevo Trap Server</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Segmentos</title>
			<para>En este apartado se muestra un listado con los segmentos que se han creado durante el proceso de registro de sensores en el Manager. 
			Se muestra la siguiente información:</para>		
			<itemizedlist mark="bullet">
				<listitem>
					<para>Segmento</para>
				</listitem>
				<listitem>
					<para>Interfaces</para>
				</listitem>
				<listitem>
					<para>Bypass: activar o desactivar la función bypass.</para>
				</listitem>
				<listitem>
					<para>Tipo de segmento</para>
				</listitem>
				<listitem>
					<para>Velocidad</para>
				</listitem>
			</itemizedlist> 
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img039.png"/>
				</imageobject>
				<caption>
					<para>Información sobre los segmentos de red del sensor</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Network routes</title>
			<para>Permite la configuración de rutas adicionales que complementan a la pasarela predeterminada.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img040.png"/>
				</imageobject>
				<caption>
					<para>Rutas estáticas de red o Network Routes</para>
				</caption>
			</mediaobject>
			<para> Es posible añadir una nueva ruta mediante la pestaña <literal>+Add Route.</literal> A continuación insertar red y pasarela de red.</para>
			<mediaobject>
				<imageobject>	
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img041.png"/>
				</imageobject>
				<caption>
					<para>Añadir nueva ruta de red: <literal>Network Route</literal></para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Location</title>
			<para>Localiza el sensor o el dominio en un mapamundi.</para>
			<para><emphasis role="bold">Añadir localización:</emphasis> es posible agregar una localización desde la opción <literal>+Add Location</literal> 
			e introducir las coordenadas, o bien, mediante el menú desplegado por el botón derecho del ratón.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img042.png"/>
				</imageobject>
				<caption>
					<para>Añadir localización del sensor: +Add Location</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img043.png"/>
				</imageobject>
				<caption>
					<para>Añadir localización del sensor: menú botón derecho</para>
				</caption>
			</mediaobject>
			<warning>
				<title>Advertencia</title>
				<para>Para poder visualizar datos en la vista <literal>Maps</literal> es necesario añadir las localizaciones de los sensores en esta interfaz.</para>
			</warning>
		</section>
		<section>
			<title>IP Variables</title> 
			<para>En este apartado se muestran los valores para las variables IP de Snort. </para>
			<para>Algunas variables de Snort deben ser modificadas (editadas) para adaptarlas a la infraestructura de red del usuario y que, de este modo, Snort pueda reconocerlas. 
			Por ejemplo, en el caso de que se hayan configurado redes locales con IPs públicas. </para>
			<para>Aquellas variables IP heredadas de un nivel superior aparecerán con un check en la casilla <literal> Inherited.</literal></para>
			<para><emphasis role="bold">Acciones disponibles:</emphasis> exportar, importar, editar y eliminar las variables IP. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img044.png"/>
				</imageobject>
				<caption>
					<para>Variables IP</para>
				</caption>
			</mediaobject>
			<note>
				<title>Nota</title>
				<para>Para más información acerca de los valores de las variables IP consultar el siguiente enlace: http://manual.snort.org/node53.html</para>
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img045.png"/>
				</imageobject>
				<caption>
					<para>Editar valores de las Variables IP</para>
				</caption>
			</mediaobject>
			<para>Es posible Exportar e importar variables IP desde las pestañas <literal>Export</literal> e <literal>Import.</literal> El formato de archivo usado en la importación y exportación debe ser .csv</para>
			<para>La opción de importación de variables ofrece la posibilidad de Añadir variables o reemplazar las existentes.</para>
			<warning>
				<title>Advertencia</title>
				<para>En caso de seleccionar la opción Importar variables -> <literal>Replace variables,</literal> 
				las nuevas variables anularán los valores que se muestran en la lista en caso de que la variable ya existiera y, ésta, no fuera heredada.</para>
			</warning>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img046.png"/>
				</imageobject>
				<caption>
					<para>Importar variables IP</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img047.png"/>
				</imageobject>
				<caption>
					<para>Exportar variables IP</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Port variables</title>
			<para>En este apartado se muestran los valores para las variables de los puertos Snort.</para>
			<para> Los valores de estas variables también pueden ser editadas en casos excepcionales en los que se hayan definido puertos no convencionales. 
			De este modo, Snort podrá reconocer dichas variables. Aquellas que sean heredadas de un nivel superior tendrán activada la casilla <literal> Inherited.</literal></para>
			<para><emphasis role="bold">Acciones disponibles:</emphasis> exportar, importar, editar y eliminar las variables de puertos. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img048.png"/>
				</imageobject>
				<caption>
					<para>Port variables</para>
				</caption>
			</mediaobject>
			<note>
				<title>Nota</title>
				<para>Para más información acerca de los valores de las variables de puertos Snort consultar el siguiente enlace: http://manual.snort.org/node54.html</para>
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img049.png"/>
				</imageobject>
				<caption>
					<para>Editar valores de las Variables de puertos Snort</para>
				</caption>
			</mediaobject>
			<para>Es posible Exportar e importar variables de puertos desde las pestañas <literal>Export</literal> e <literal>Import.</literal> El formato de archivo usado en la importación y exportación debe ser .csv</para>
			<para>La opción de importación de variables ofrece la posibilidad de Añadir variables o reemplazar las existentes.</para>
			<warning>
				<title>Advertencia</title>
				<para>En caso de seleccionar la opción Importar variables -> <literal>Replace variables</literal> las nuevas variables anularán los valores que se muestran en la lista en caso de que la variable ya existiera y ésta, 
				no fuera heredada.</para>
			</warning>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img050.png"/>
				</imageobject>
				<caption>
					<para>Importar variables de puertos Snort</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch04_img051.png"/>
				</imageobject>
				<caption>
					<para>Exportar variables de puertos Snort</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Groups</title>
			<para><emphasis role="bold">Grupo:</emphasis> es un conjunto de instancias asociadas a un procesador concreto que leen de uno o más segmentos en un modo determinado.</para>
			<para><emphasis role="bold">Instancia:</emphasis> es una asociación de un grupo de segmentos a un procesador o procesadores. En caso de que hayamos creado más de una instancia para un mismo grupo, 
			es necesario tener configurados el mismo número de bindings que de instancias.</para>
			<para><emphasis role="bold">Binding</emphasis> es una partición del tráfico por red o VLAN. Es "hijo" de un grupo de segmentos.</para>
			<para>El usuario puede asignar una política a tres niveles: sensor, grupo de segmentos o bindings.</para>
			<para>Esto aumenta la flexibilidad asociada al software, ya que, a diferencia de la anterior versión en la que una política debía aplicarse por completo para un sensor (independientemente de los segmentos creados), 
			permite la formación de grupos de segmentos independientes y bindings.</para>
			<note>
				<title>Nota</title>
				<para><emphasis role="bold">El sistema de herencias se establece desde los niveles superiores y aplicará a los niveles inferiores que cuelguen de él.</emphasis></para>
				<para>Los parámetros de configuración y las políticas de los niveles superiores afecta a aquellos "hijos" que cuelguen o dependan de ellos. En caso de que no se edite la configuración de dichos hijos,
				el sistema asignará por defecto las políticas, modos y configuraciones asignadas al nivel "padre".</para> 	
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img052.png"/>
				</imageobject>
				<caption>
					<para>Grupos de segmentos</para>
				</caption>
			</mediaobject>
			<para>En este apartado se puede realizar la configuración de los grupos de segmentos:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold">Name:</emphasis> editar nombre del grupo</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Sensor mode:</emphasis> selección del modo que se aplicará a nivel de grupo (se hereda por defecto el modo del sensor)</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Segments:</emphasis> indica el/los segmentos incluidos en el grupo</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">CPUs:</emphasis> asignación del procesador o procesadores de los que va a leer el grupo de segmentos.</para>
				</listitem>
			</itemizedlist>
			<important>
				<title>Importante</title>
				<para>Cuando existe más de un grupo de segmentos es recomendable que se le asignen procesadores o CPUs 
				diferentes a cada grupo para distribuir los procesos y balancear de este modo la carga de cada procesador.</para>
			</important>
			<section>
				<title>Condiciones para la creación de grupos de segmentos</title>
				<itemizedlist mark="bullet">
					<listitem>
						<para>No es posible que dos grupos compartan los mismos segmentos.</para>
					</listitem>
					<listitem>
						<para>Dos instancias del mismo grupo no pueden tener distintos modos <literal>(Sensor mode).</literal></para>
					</listitem>
					<listitem>
						<para>Sensores IPS/IDS: solo pueden colgar de ellos sus propios grupos y bindings.</para>
					</listitem>
					<listitem>
						<para>Los grupos y los bindigs pueden moverse y hacerlos depender de dominios. Sin embargo, estos, tan solo pueden ser devueltos al sensor IPS al que pertenecían antes de moverlos.</para>
					</listitem>
				</itemizedlist>
			</section>
			<section>
				<title>Añadir grupo de segmentos/ Editar grupo de segmentos</title>
				<para>Para añadir un nuevo grupo basta con seleccionar la opción <literal>+Add Group.</literal></para>
				<para>Para la edición de un grupo ya existente, hacer clic sobre el icono "Editar".</para>
				<para>En ambos casos, el usuario accederá a la interfaz de configuración a nivel de grupo. En ella puede modificar la siguiente información:</para>
				<itemizedlist mark="bullet">
					<listitem>
						<para><emphasis role="bold">Name:</emphasis> editar nombre del grupo. </para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Description:</emphasis> añadir una descripción al grupo de segmentos.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">IPS/IDS Settings:</emphasis> configuración de los parámetros de Snort a nivel de grupo. </para>				</listitem>
					<listitem>
						<para><emphasis role="bold">IP Variables:</emphasis> listado de valores para las variables IP de Snort a nivel de grupo. 
				Algunas variables de Snort deben ser modificadas (editadas) para adaptarlas a la infraestructura de red del usuario y que, de este modo, Snort pueda reconocerlas. 
				Aquellas que sean heredadas de un nivel superior, aparecerán con un check en la casilla <literal> Inherited.</literal></para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Port Variables:</emphasis> En este apartado se muestran los valores para las variables de los puertos Snort a nivel de grupo. 
						Los valores de estas variables también pueden ser editadas en casos excepcionales en los que se hayan definido puertos no convencionales. 
				De este modo, Snort podrá reconocer dichas variables. Aquellas que sean heredadas de un nivel superior, aparecerán marcadas como <literal> Inherited.</literal></para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Bindings:</emphasis> los bindings son particiones del tráfico a través de red o VLAN. Actúan como "hijos" del grupo a nivel de herencias y aplicación de políticas. 
					Para añadir un nuevo binding hacer clic en <literal>+Add binding</literal> e introducir el nombre.</para>
					</listitem>
				</itemizedlist>
				<note>
					<title>Nota</title>
					<para>Recuerde que el grupo de segmentos mostrará la configuración que ha heredado del sensor. Esta es la que se mostrará por defecto en la pantalla de edición a nivel de grupo.</para>
				</note>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img053.png"/>
					</imageobject>
					<caption>
						<para>Añadir/editar grupo de segmentos</para>
					</caption>
				</mediaobject>
					<para><emphasis role="bold">Eliminar un grupo de segmentos</emphasis></para>
					<para>En cualquier momento se puede borrar un grupo mediante el icono "Eliminar". El sistema mostrará un mensaje de confirmación. </para>
				<important>
					<title>Importante</title>
					<para>En caso de que un grupo tuviera asignada una serie de políticas, al eliminar el grupo, estas dejarán de aplicarse en los segmentos que pertenecían al grupo. 
				Los segmentos quedarán libres para su integración en otro grupo. </para>
				</important>
			</section>
			<section>
				<title>Eliminar un grupo de segmentos</title>
				<para>En cualquier momento se puede borrar un grupo mediante el icono "Eliminar". El sistema mostrará un mensaje de confirmación. </para>
					<important>
					<title>Importante</title>
					<para>En caso de que un grupo tuviera asignada una serie de políticas, al eliminar el grupo, estas dejarán de aplicarse en los segmentos que pertenecían al grupo. 
					Los segmentos quedarán libres para su integración en otro grupo. </para>
				</important>
			</section>
			<section>
				<title>Bindings</title>
					<para><emphasis role="bold">Añadir/editar configuración de bindings</emphasis></para>
					<para>Existen dos maneras de añadir o editar un binding:</para>
					<orderedlist numeration="arabic">
					<listitem>
						<para>Pantalla de configuración de sensor IPS/IDS: Groups -> Icono edición -> Bindings-> <literal>+ Add binding</literal>/Icono edición</para>
					</listitem>
					<listitem>
						<para>Pantalla de configuración de sensor IPS/IDS: <literal>+ Add Group</literal> -> Bindings -> <literal>+ Add binding</literal>/Icono edición</para>
					</listitem>
				</orderedlist>
				<para>Cuando añadimos un nuevo binding el sistema nos solicita un nombre.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img054.png"/>
					</imageobject>
					<caption>
						<para>Grupos de segmentos -> Bindings</para>
					</caption>
				</mediaobject>
				<note>
					<title>Nota</title>
					<para>Para que un binding sea tenido en cuenta, hay que asignarle, al menos, una Vlan.</para>
				</note>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img055.png"/>
					</imageobject>
					<caption>
						<para>Editar configuración de bindings</para>
					</caption>
				</mediaobject>
				<para>Los campos de edición para la configuración a nivel de binding son los siguientes:</para>
				<itemizedlist>
					<listitem>
						<para>General: Nombre y descripción.</para>
					</listitem>
					<listitem>
						<para>IPS/IDS Settings</para>
					</listitem>
					<listitem>
						<para>IP Variables</para>
					</listitem>
					<listitem>
						<para>Port Variables</para>
					</listitem>
				</itemizedlist>
				<para>Para asegurarse de que las modificaciones realizadas en un binding ya existentes se van a aplicar correctamente, hacer clic en <literal>Update</literal></para>
				<warning>
					<title>Advertencia</title>
					<para>En caso de que los campos IPS/IDS Settings, IP Variables y Port Variables no sean modificados, el binding heredará la configuración del grupo de segmentos del que depende. </para>
				</warning>
			</section>
		</section>
	 </section>
	 <section>
		<title>Herencias de las políticas</title>
		<para>Como hemos visto anteriormente, <footnote><para>Consultar capítulo: "Sensores" para más información sobre dependencias y organización jerárquica en redborder.</para></footnote> la organización de los elementos de red 
		creados en redborder es jerárquica y por tanto, establece dependencias entre niveles y otros.</para>
		<para>Estas dependencias establecen un sistema de herencias que afecta tanto en la configuración como en las políticas aplicadas en cada uno de los niveles (de mayor a menor jerarquía):</para>
		<itemizedlist>
			<listitem>
				<para>Root</para>
			</listitem>
			<listitem>
				<para>Dominio</para>
			</listitem>
			<listitem>
				<para>Sensores</para>
			</listitem>
			<listitem>
				<para>Grupo</para>
			</listitem>
			<listitem>
				<para>Binding</para>
			</listitem>
		</itemizedlist>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img056.png"/>
			</imageobject>
			<caption>
				<para>Sensors -> Tree: jerarquías y dependencias entre niveles</para>
	 		</caption>
		</mediaobject>	
		<note>
			<title>Nota</title>
			<para>El sistema de herencias establece que la configuración de los niveles superiores afecta a la de aquellos "hijos" que cuelguen o dependan de ellos. En caso de que no se edite la configuración de dichos hijos,
			el sistema asignará por defecto las políticas, modos y configuraciones asignadas al nivel "padre". 
			<emphasis role="bold">El sistema de herencias se establece por tanto, desde los niveles superiores y aplicará a los niveles inferiores que cuelguen de él.</emphasis></para>
		</note>
		<para><emphasis role="bold">General Settings</emphasis></para>
		<para>En la sección <literal>Tools</literal> encontramos la opción de <literal>General Settings</literal> desde la cual el usuario puede establecer la configuración de los parámetros generales del Manager. </para>
		<para>Este es el máximo nivel de configuración (es como si se tratara del dominio <emphasis role="bold">root</emphasis>) por lo que las propiedades que aquí se definan serán heredadas 
		por el resto de dominios y sensores que se encuentren por debajo de este nivel.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img057.png"/>
			</imageobject>
			<caption>
				<para>General Settings: Configuración General del Manager o "root"</para>
	 		</caption>
		</mediaobject>
		<para><emphasis role="bold">Configuración heredada: "Inherited"</emphasis></para>	
		<para>Cuando se crea un dominio o sensor o se edita por primera vez, obervaremos que algunos parámetros vienen acompañados de la etiqueta 
		<emphasis role="bold">"Inherited"</emphasis>, esto quiere decir que han heredado los valores heredados de la configuración general del Manager
		 o de los dominios o sensores que se encuentren por encima del elemento recién creado. 
		Para cambiar esta configuración, el usuario deberá sobreescribir esa información.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch04_img058.png"/>
			</imageobject>
			<caption>
				<para>Inherited: Configuración heredada de sensores IPS/IDS</para>
	 		</caption>
		</mediaobject>
    </section>	
</chapter>		
