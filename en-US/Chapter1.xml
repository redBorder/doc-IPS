<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2020">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Installing the redBorder Enterprise Edition IPS</title>
    <section>
		<title>What is an IDS?</title>
		<para><emphasis role="bold">IDS</emphasis> is an Intrusion Detection System in the network to protect one organization.</para> 
		<para>It is a specific software that runs in user space and analyse network traffic (using a mirror port or SPAN) in one system interface or between two interfaces joined as a bridge (software switch).</para>
		<para>The traffic is analyzed for anomalies, specific signatures or suspicious behaviors.</para> 
		<para>The goal of an IDS is <emphasis role="bold">to dectect intrusions and create alerts without interrupting the traffic in the organization.</emphasis></para>
    </section>
    <section>
		<title>What is an IPS?</title>
		<para><emphasis role="bold">IPS</emphasis> is an Intrusion Prevention System that works in the network or networks inside an organization.</para> 
		<para>It works in the same way as an IDS (in fact it normaly uses the same software with an adapted behavior), in this case an IPS can block the traffic in the organization,
		 in that way when an attack is detected the system can choose between 
		 <emphasis role="bold">showing alerts or discard those packets, working in a similar way as a firewall.</emphasis></para>
		 <para>The configuration and registration of the IPS/IDS sensors into the Manager is the next step to the installation one. This process consist in two steps:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Installation and registration of the IPS/IDS sensors in the Manager</para>							
			</listitem>	
			<listitem>
				<para>Configuration of basic parameters in the redborder platform</para>
			</listitem>
		</itemizedlist>
	</section>
	<section>
	    <title> Requirements</title>
	    <para> <emphasis role = "bold"> redBorder IPS</emphasis> is a software that needs the following requirements in order to function correctly. The minimum essential elements required for the installation as well as those recommended for correct performance are referenced at every SNORT instance being executed. They are shown in the following table:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "350" fileref ="images/ch01_img001.png"/>
            </imageobject>
            <textobject>
				<phrase> Figure 1: Requirements for installing redBorder IPS</phrase>
            </textobject>
            <caption>
                <para> Figure 1: Requirements for installing redBorder IPS </para>
            </caption>
        </mediaobject>
		<para> For example, if you want four SNORT instances in the recommended configuration, you need a machine with 16 GB and four cores.</para>
                <warning>
                  <title> Warning </title>
                  <para> It is VERY IMPORTANT that the configuration of the Manager (or cluster of managers) is performed before configuring IPS sensors. </para>
                  <para> The Manager must be operational and in a network accessible to the sensors. Some of the sensor configuration processes depend on the access to the Manager. </para>
                </warning>
	</section>	
	<section>
		<title>Obtaining the ISO</title>
		<para> Redborder Enterprise Edition IPS is distributed as an ISO file that can be obtained in different ways. If you don’t have it, please contact our sales team (sales@redborder.com) or our support team (support@redborder.com) to provide you with the last available ISO file or a way to download it.</para>
	</section>	
	<section>
		<title>Burning the ISO Image</title>
		<para> The ISO image is prepared to perform the boot from a DVD reader, USB device or as an ISO file for a virtual machine.</para>
		<para><emphasis role = "bold">NOTE: The process of creating a bootable USB for the IPS installation is the same as for the manager installation. You can find it accessing the support page.</emphasis></para>
		<para>In order to burn the ISO image from a Linux system to a USB device, the following command needs to be used if the USB device is mapped in /dev/sdd:</para>
		<programlisting>[root@machine ~]# dd if=redBorder-3.1.80-18-x86_64-6.5-sensor.iso of=/dev/sdd bs=10M</programlisting>
	</section>	
	<section>
		<title>Installing the ISO</title>
		<para><emphasis role = "bold">NOTE: If a usb memory is used on a real machine, the operating system will be automatically extending the disk and the data on the usb will be lost. To avoid this, the usb needs to be removed before rebooting.</emphasis></para>
		<para>Once you have booted the redborder ISO, you will see the installation menu. To perform the installation, select the option: Install Sensor IPS:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img002.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 2: Installation process</phrase>
            </textobject>
            <caption>
                <para>Figure 2: Installation process</para>
            </caption>
        </mediaobject>
		<para>Once in the installation process, the user only needs to confirm the installation destination and root password. Redborder is prepared for unattended installations and so you should be especially careful with the time you have to respond to these three questions if you wish to modify the default options:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img003.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 3: Installation process</phrase>
            </textobject>
            <caption>
                <para>Figure 3: Installation process</para>
            </caption>
        </mediaobject>
		<para>Once this page has been confirmed, the installation will carry out all of the necessary processes to prepare the system for configuration.</para>
		<para>By default, the root password will be <emphasis role = "bold">redborder</emphasis>.</para>
	</section>	
	<section>
		<title>Basic Configuration</title>
		<para>Upon completing the installation process, you have two configuration options depending on whether or not there is a DHCP server.</para>
		<itemizedlist mark = "bullet">
			<listitem>
				<para>Dynamic IP (DHCP): in this case, redBorder will have acquired an IP in its network interface.</para>
			</listitem>
			<listitem>
				<para>Static IP: in this case redborder will not have any IP assigned.</para>
			</listitem>
		</itemizedlist>
		<para>In both cases you will have to access the system in order to configure and register the sensor in the manager. You will access with the root user and password that was selected during installation.</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img004.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 4: Basic Configuration</phrase>
            </textobject>
            <caption>
                <para>Figure 4: Basic Configuration</para>
            </caption>
        </mediaobject>
		<para>Once inside the system you will start the configuration manager. To do this, you will execute:</para>
		<programlisting>[root@rbmanager ~]# rb_sysconf</programlisting>
		<para>A menu with different options will appear:</para>
		<mediaobject>
            <imageobject>
                <imagedata scalefit = "1" align = "center" width = "450" fileref ="images/ch01_img005.png"/>
            </imageobject>
            <textobject>
				<phrase>Figure 5: Basic Configuration</phrase>
            </textobject>
            <caption>
                <para>Figure 5: Basic Configuration</para>
            </caption>
        </mediaobject>
        <para>Once execute <literal>rb_sysconf</literal> you will access the <emphasis role="bold">redborder configuration menu</emphasis>.</para>
		<para>There are 5 options:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para><literal>System Configuration:</literal> here you can define and modify basic settings such as hostname, date, time, etc.</para>
			</listitem>
			<listitem>
				<para><literal>Network Configuration:</literal> this is the option where you can configure the network settings.</para>
			</listitem>
			<listitem>
				<para><literal>Passwords:</literal> access this option if you need to change your credentials.</para>
			</listitem>
			<listitem>
				<para><literal>Update rules from Manager:</literal> select this option to force a rule update from the Manager (optional).</para>
			</listitem>
			<listitem>
				<para><literal>quit:</literal> exit.</para>
			</listitem>
		</orderedlist>
		<section>
		<title>Network configuration</title>
		<para>IDS/IPS sensors need to comunicate with the el Manager, to make this possible some network configuration is needed. Select option <literal>2) Network Configuration</literal> from the redborder configuration menu.</para>
		<para>Until this setting is not made properly, the sensor will not be able to be registered in the Manager.</para>
		<para>Those are the steps you need to follow to network configure your sensor:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para>Managagement network configuration:</para>
				<para>a) Make a bonding and assign management interface.</para>
				<para>b) Segments configuration.</para>	
			</listitem>
			<listitem>
				<para>Doman and DNS configuration</para>
			</listitem>
		</orderedlist>
		<note>
			<title>Note</title>
			<para>The order to configure the management network can be different. The order described on this manual is considered to be the more optimal one.</para>
		</note>
		<warning>
			<title>Warning</title>
			<para>In case the system is install in a machine with multiples network interfaces, the user need to select the one that will be the management bonding.</para>
		</warning>
	</section>
	<section>
		<title>Interface asignement and bonding creation</title>
		<para>Select <literal>Network Configuration</literal> typing option <keycap>2</keycap> y press <keycap>Enter.</keycap></para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img016.png"/>
			</imageobject>
		<caption>
			<para>Automatic bypass segmenet detection</para>
		</caption>
		</mediaobject>
		<para>In case the system detect <emphasis>bypass</emphasis> interfaces, the will be added automaticaly as segments.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img017.png"/>
			</imageobject>
			<caption>
				<para>Network sensors configuration</para>
			</caption>
		</mediaobject>
		<para>To configure the network configuration correclty:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Bonding creation: (4 bonds max).</para>
			</listitem>
			<listitem>
				<para>Selection and assigment of bonding ports.</para>
			</listitem>
			<listitem>
				<para>Managmenet network interfaces selections for the bondings.</para>
			</listitem>
		</itemizedlist>
		<para>The system will show a detailled list that will help the administrator to decide which ports are available to bonding creation.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img018.png"/>
			</imageobject>
			<textobject>
				<phrase>Insert bonding port</phrase>
			</textobject>
			<caption>
				<para>Insertar bonding port</para>
			</caption>
		</mediaobject>
		<note>
			<title>Note</title>
			<para>To select the default parameters press: <keycap>Enter</keycap></para>
		</note>
		<section>
			<title>Creation of a new bonding and port assignments</title>
			<para>To show t his process we will create a bonding (bond0) with 2 ports.</para>
			<para>Select option <keycap>n</keycap> from the right lateral submenu.</para>
			<para>All available ports will be shown, select the one that you want to be part of the bonding.</para>
			<para>Introduce port number in <literal>Insert bonding first port [0]:</literal></para>
			<para>The number between the brackets <literal>[]</literal> is the one that the system defined by default. To selectt this number press <keycap>Enter.</keycap></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img019.png"/>
				</imageobject>
				<textobject>
					<phrase>Bonding creation: port assignments</phrase>
				</textobject>
				<caption>
					<para>Bonding creation: port assignments</para>
				</caption>
			</mediaobject>
			<para>The selected port will disappear from the list of available ports.</para>
			<important>
				<title>Important</title>
				<para>The system only allows a maximum of 4 bonds: (0-3).</para>
			</important>
		</section>
		<section>
			<title>Add an extra bonding port</title>
			<para>The sytem will ask: <literal>Insert second port (y/N)</literal></para>
			<para>The default option is the opne with uppercase. Remember that if you dont need to add a new port you only need to press <keycap>Enter</keycap>.</para>
			<para>In case you want to add an extra port press <keycap>y</keycap>.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img020.png"/>
				</imageobject>
			<textobject>
				<phrase>Add new port to the bonding</phrase>
			</textobject>
			<caption>
				<para>Add new port to the bonding</para>
			</caption>
			</mediaobject>
			<para>Insert the port number <literal>Insert bonding second port [1]:</literal></para>
			<para>The number between brackets <literal>[]</literal> is the default setting. To select this number just press <keycap>Enter</keycap>.</para>			
		</section>
		<section>
			<title>Bonding network configuration</title>
			<para>Once the assigment of the second port is made on the new bonding (bond0), the system will ask the following:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>IP Address</para>
				</listitem>
				<listitem>
					<para>Network mask</para>
				</listitem>
				<listitem>
					<para>Gateway</para>
				</listitem>
				<listitem>
					<para>Routes</para>
				</listitem>
			</itemizedlist>
			<para>If your device uses DHCP, an IP address will be assign by default. Press <keycap>Enter</keycap> to select the IP, network mask and gateway assign by the system.  In other case, enter manually those values.</para>
			<para>The system also add default routes for the new bonding.</para>
			<para>To insert a manual route, select option <keycap>y</keycap> in <literal>Insert a route for this bonding (y/N)?:</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img021.png"/>
				</imageobject>
				<caption>
				<para>Add a manual route to the bonding</para>
			</caption>
			</mediaobject>
			<para>Once this process is finish, a message will appear: <literal>Bonding 0 created successfully.</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img022.png"/>
				</imageobject>
			</mediaobject>
		</section>
		<section>
			<title>Finish bonding creation process</title>
			<para>Befor apply the changes and finish the bonding creation process the system will show a table with the new bonding (bond0) next to the used ports, IP, network mask and routes.</para>	
			<para><emphasis role="bold">Apply changes</emphasis></para>
			<para>To save the setings, you should apply the changes selection the option <keycap>a.</keycap></para>
			<para>You can delte in any moment the bond or bonds made selecting option <literal>delete bonding</literal> pressing the key <keycap>d.</keycap></para>
			<para>To go back to the main menu, select option <literal>quit</literal> pressing <keycap>q.</keycap></para>
		</section>
	</section>
	<section>
		<title>Domain and DNS configuration</title>
		<para>On the network menu configuration we can find this option <literal>DNS and domain settings.</literal> To start the process, select option<keycap>2.</keycap></para>
		<para>In order to configure this correctly the user will need to introduce:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Domain name</para>
			</listitem>
			<listitem>
				<para>Primary DNS address</para>
			</listitem>
			<listitem>
				<para>Secondary DNS address (opcional)</para>
			</listitem>
		</itemizedlist>
		<para>Once the values are set, the system will show a message telling the configuration was made successfully.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img023.png"/>
			</imageobject>
		<caption>
			<para>Domain and DNS configuration</para>
		</caption>
		</mediaobject>
		<para>To end this process, no apply changes is needed, select option <literal>quit</literal> pressing <keycap>q</keycap> to go back to the main network menu.</para>
	</section>
	<section>
		<title>Segments configuration</title>
		<para>Select option <literal>Segment settings</literal> pressing the number <keycap>3</keycap>.</para>
		<para>This screen will show the current number of segments, ports of each segment and if they support bypass.</para>
		<para>On this section you will find the folling submenu:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para><keycap>f)</keycap> <literal>force bypass autoassign:</literal>to foce automaticaly bypass port assigment.</para>
			</listitem>
			<listitem>
				<para><keycap>n)</keycap> <literal>new segment:</literal>selection this option to make a new segment.</para>
			</listitem>
			<listitem>
				<para><keycap>d)</keycap> <literal>delete segment:</literal>to delete one segment.</para>
			</listitem>
			<listitem>
				<para><keycap>q)</keycap> <literal>quit:</literal>exit.</para>
			</listitem>
		</itemizedlist>
		<para>To make a new segmenet select <literal>n) new segment.</literal></para>
		<para>This process include the following actions:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para>Assigment of bypass interfaces to the segments (opcional).</para>
			</listitem>
			<listitem>
				<para>Creation of one segmenet: (max 16 segments).</para>
			</listitem>
			<listitem>
				<para>Select and assign ports to a segment.</para>
			</listitem>
		</orderedlist>
		<para> In order to select a port, a detaill list will be shown, this will help the adminsitator to decided which ports will be use by the segments.</para>
		<section>
			<title>Bypass interfaces selection</title>
			<para>When the system detects bypass interfaces, it will be added automacticaly after access the network configuration menu.</para>
			<para>There are also two extra ways assign a port:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold"> Force bypass autoassign:</emphasis> sellect option <literal>Force bypass auto assign</literal> on the segment configuration menu pressing <keycap>f</keycap>.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Manual assigment:</emphasis> select bypass ports from the list of available ports.</para>				
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img024.png"/>
				</imageobject>
			<caption>
				<para>Assign ports to a segment</para>
		    </caption>
			</mediaobject>
		</section>
		<section>
			<title>Creation of a new segment</title>
			<para>As an example we are gonna make a segment (segment 0) and will be assign 2 ports.</para>
			<para> To begin the process select option <keycap>n</keycap> that appears in the right submenu.</para>
			<para>Once you have check all available ports, select the one that you wan to include in the segment.</para>
			<para>Introduce the segment number on <literal>Insert segment number (0-15) [0]:</literal></para>
			<para>Th number between brackets <literal>[]</literal> is the default one. To select this number just press <keycap>Enter</keycap>.</para>
		    <para>The previous assig port will disappear from the list of available ports.</para>
		    <note>
				<title>Note</title>
				<para>The system only allow a maximum of 16 segments (0-15).</para>
		    </note>
		</section>
		<section>
			<title>Add a second port to the segment</title>
			<para>Once assign the first port to the segment, the system will ask for a second one: <literal>Assign second port to the segment (Y/n):</literal></para>
			<para>By default the option is the one in uppercase.</para>
			<para>Remember if you want to assign a new port you only need to press <keycap>Enter</keycap>.</para>
			<para>In another case just press <keycap>n</keycap>. Select an available port from the list.</para>
			<para>Enter the number of the port on <literal>Insert segment second port [3]:</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img025.png"/>
				</imageobject>
			<caption>
				<para>Assign new port to the segment</para>
			</caption>
		    </mediaobject>
			<para>Once the ports were assign to a segment, the system will show a message: <literal>Segment 0 created successfully.</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img026.png"/>
				</imageobject>
			<caption>
				<para>Confirmation of segment creation</para>
			</caption>
			</mediaobject>
		</section>
		<section>
			<title>Finish the segment creation process</title>
			<para>Before applying the changes and finish the process, the system will show the settings:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>Segments</para>
				</listitem>
				<listitem>
					<para>Assigned ports</para>
				</listitem>
				<listitem>
					<para>Bypass support</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img027.png"/>
				</imageobject>
			<caption>
				<para>Assigned ports</para>
			</caption>
			</mediaobject>		
			<para><emphasis role="bold">Apply changes</emphasis></para>
			<para>To save the settings press <keycap>a.</keycap></para>
			<para>You can delete in any moment the created segments by selection <literal>delete segment</literal>, pressing  <keycap>d</keycap>.</para>
			<para>To go back to the main network configuration menu select <literal>quit</literal> by pressing <keycap>q</keycap>.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img028.png"/>
				</imageobject>
			<caption>
				<para>Segments overview</para>
			</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img029.png"/>
				</imageobject>
			<caption>
				<para>Apply changes to finish segment creation process</para>
			</caption>
			</mediaobject>		
		</section>
	</section>
	<section>
		<title>Manager sensor registration</title>
		<para>To finish the installation process of the IPS/IDS sensors the last step consist in <emphasis role="bold">Manager sensors registration.</emphasis></para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img030.png"/>
			</imageobject>
			<caption>
				<para>Start of sensor registation process</para>
			</caption>
	    </mediaobject>	
		<para>In the sensor registration menu we can find the following options:</para>
		<orderedlist numeration="arabic">
			<listitem>
				<para><literal>Hostname [rbsensor]:</literal> assign a sensor name.</para>
			</listitem>
			<listitem>
				<para><literal>Set local time:</literal> configure local time.</para>
			</listitem>
			<listitem>
				<para><literal>IP adress for rB Master Manager [127.0.0.1]:</literal> introduce the Manager IP.</para>
			</listitem>
			<listitem>
				<para><literal>Register rB:</literal> register the sensor into the Manager.</para>
			</listitem>
		</orderedlist>
		<section>
			<title>Assign sensor name (Hostname)</title>
			<para> Select the option <literal>Hostname [rbsensor]</literal> from the registration menu pressing <keycap>1</keycap>.</para>
			<para> Next, on the line <literal>Insert Hostname [rbsensor]:</literal> type the name you which for your sensor. This name will be appear in the the web on the sensor list.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img031.png"/>
				</imageobject>
			<caption>
				<para>Assign sensor name</para>
			</caption>
			</mediaobject>
			<note>
				<title>Note</title>
				<para>Remember to use a good name and avoid generic names like “Sensor”.</para>
			</note>
			<warning>
				<title>Warning</title>
				<para>The system will ask you to  verify the sensor name, in that case press <keycap>Enter</keycap></para>
				<para>If you want to make a modification press <keycap>n</keycap></para>
				<para>The system will change the sensor name. To continue and go back the to the main systm menu press any key  <literal>Press a key to continue...</literal></para>
			</warning>	
		</section>		
		<section>
			<title>Local time configuration</title>
			<para>Select option <literal>2) Set local time.</literal></para>
			<para>Insert date and time of your country. </para>
			<para> The system will show the support format:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><literal>[HH:mm]</literal> ó <literal>[YYYY/MM/DD]</literal></para>
				</listitem>
				<listitem>
					<para><literal> [YYYY/MM/DD HH:mm]</literal></para>
				</listitem>
			</itemizedlist>
			<para>Press <keycap>Enter</keycap> to continue with the registration process.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img032.png"/>
			    </imageobject>
			   <caption>
				<para>Sensor registration in the Manager: Select local time</para>
			</caption>
		    </mediaobject>
		</section>
		<section>
			<title>Introduce Master Manager IP</title>
			<para>Select option <literal>3) IP adress for rB Master Manager [.*].</literal></para>
			<para>Type the IP address or domain name of the Manager. The system will check if the Manager can be reached. This process may take a few seconds.</para>
			<para>The system will sincronize the time of the machines and then it will reboot some time related services.</para>
			<para> Congratulations! Your machine is ready to make the registration with the Manager.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img033.png"/>
			    </imageobject>
			   <caption>
				<para>Introduce Master Manager IP</para>
			</caption>
		    </mediaobject>
		    <para>To continue and go back to the system configuration menu press any key <literal>Press a key to continue...</literal></para>
		</section>
		<section>
			<title>Sensor registration</title>
			<para>This is the last step to configure your redborder IPS/IDS sensor.</para>
			<para> From now on you will be able to manage your IPS/IDS sensor from the main application and visualize in a graphic way all the generated events using dashboards. </para>
			<para>With this application you will be able to create reports, visualize events and configure some rules to take actions. </para>
			<para><emphasis>Finish registration process in the Manager</emphasis></para>
			<para> To complete the registration process follow these steps:</para>
			<orderedlist numeration="arabic">
				<listitem>
					<para>Show debug output: the system will ask <literal>Would you like to have a debug output?</literal> Select default option (No) pressing the key <keycap>N</keycap>.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Insert password:</emphasis> type the password that you use in the Manager basic configuration phase.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Temporal syncronization (automaticaly) between the Manager and its sensors:</emphasis> this process may take some seconds.</para>
		        </listitem>
		     </orderedlist>
		     <mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img034.png"/>
				</imageobject>
			<caption>
				<para>Finish sensor registration process</para>
			</caption>
			</mediaobject>
				<para>After these steps the system will show a successfully registation message.</para>
				<para><literal>Sensor registered succesfully with chef server</literal></para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img035.png"/>
			        </imageobject>
			    <caption>
					<para>Sensor registrastion into the server</para>
				</caption>
		    </mediaobject>
			<warning>
				<title>Warning</title>
				<para>Do not change the sensor name or <emphasis>hostname</emphasis> once is registered. If you want to make those changes you will need to undo the registration process and start over.</para>
			</warning>
			<para>To continue and go back to the system configuration menu press any key <literal>Press a key to continue...</literal></para>
			<para>In the sensor registration menu you can verify that the sensor was register successfully:<literal>(Registered).</literal></para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img036.png"/>
			    </imageobject>
			    <caption>
					<para>Successful sensor registration</para>
				</caption>
		    </mediaobject>
		    <para> To exit, select option <literal>quit</literal> pressing <keycap>q.</keycap></para>				
		</section>
	</section>
	<section>
	<title>IPS/IDS sensors configuration</title>
	<para> You need to access the redborder Manager web interface to configure your IPS/IDS sensors.</para>
	<para><screen>https://IP-manager-address</screen></para>
	<note>
		<title>Note</title>
		<para>It is possible to log in to the platform using the default account: <emphasis role="bold">admin or admin@redborder.com</emphasis>
		 with the password used during the Manager installation process.</para>
	</note>
	<warning>
		<title>Warning</title>
		<para>The web will not work if you try to access using a non encrypted method (https).</para>
	</warning>
	<para>There are three ways to access the IPS/IDS sensor params configuration:</para>
	<itemizedlist mark="bullet">
		<listitem>
			<para><emphasis role="bold">Tree view:</emphasis> in the tree view users can see all the IPS/IDS created sensors next to its identify icon. 
			Click on the sensor name or press the <literal>"Edit"</literal> to access to the sensor configuration view</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img037.png"/>
				</imageobject>
				<caption>
					<para>Tree view: edit IPS/IDS sensor</para>
				</caption>
			</mediaobject>
		</listitem>
		<listitem>
			<para><emphasis role="bold">Access Points view:</emphasis> the Access Points view show a list of APs defined on the network. 
			Click on one Access Point to access the configurtatio interface with general sensor parameteres. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="150" fileref="images/ch01_img038.png"/>
				</imageobject>
				<caption>
					<para>Access Points view: edit IPS/IDS sensor</para>
				</caption>
			</mediaobject>
		</listitem>
		<listitem>
			<para><emphasis role="bold">IPS view:</emphasis> on the <literal>View</literal> option you can find the defailled sensor view.
			Select <literal>IPS sensors</literal> to access to an alphabetical order IPS/IDS sensors list. Then click on the "Edit" icon.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img039.png"/>
				</imageobject>
				<caption>
					<para>IPS Sensors view: IPS/IDS</para>
				</caption>
			</mediaobject>
		</listitem>
	</itemizedlist>
		<section>
		<title>Edit IPS/IDS sensor</title>
			<para>In all these cases the user acess to a basic parameteres configuration IPS/IDS sensor view. </para>
			<para>The formulary configuration fields can change depending if you are editing a sensor, segments group or binding.
			This step is very important because this configuration will change the way the sensor works depending on differente scenarios. 
			This options are defined in the section <emphasis role="bold">IPS/IDS configuration.</emphasis></para>
			<para>This is a list of the options you can modify on a IPS/IDS edit view:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>General: show general sensor information. The only option you can edit on this section is the description.
					<footnote><para>IP address and sensor name were defined during the installation and registration process.</para></footnote></para>
				</listitem>
				<listitem>
					<para>IPS/IDS Settings</para>
				</listitem>
				<listitem>
					<para>Servers</para>
				</listitem>
				<listitem>
					<para>Trap servers</para>
				</listitem>
				<listitem>
					<para>Segments</para>
				</listitem>
				<listitem>
					<para>Network routes</para>
				</listitem>
				<listitem>
					<para>Location</para>
				</listitem>
				<listitem>
					<para>IP Variables</para>
				</listitem>
				<listitem>
					<para>Port variables</para>
				</listitem>
				<listitem>
					<para>Groups</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img039.png"/>
				</imageobject>
				<caption>
					<para>Editable information for IDS/IPS sensor configuration</para>
				</caption>
			</mediaobject>
			<para>In the upper right corner of the screen we find the following options:</para> 
			<itemizedlist mark="bullet">
				<listitem>
					<para><literal>Stop Auto-apply</literal></para>
					<para>This button prevents Chef from automatically applying the changes (it refreshes and applies every 5 minutes).</para>
					<para>The system will open a confirmation window to make sure that this is the action the user wants to perform.</para>
				</listitem>
				<listitem>
					<para><literal>Options-> Recreate Private Key</literal></para>
					<para>This option regenerates the synchronization private key of the IPS sensor with the Manager. If you have Administrator role in redborder,
You will also find this option in the user editing interface in <literal>Tools -> Users</literal>.</para>
					<para>Once said restoration has been confirmed, the user must enter the text that is shown in the modal window in the IPS following the following path:: 
					<computeroutput>/etc/chef/client.pem</computeroutput></para>
				</listitem>
			</itemizedlist>
			<warning>
				<title>Warning</title>
				<para><emphasis role="bold">The action of restoring the private key is very sensitive since it can leave the sensor without communication with the Manager.</emphasis> Por ello, el sistema abre una ventana de confirmación antes de realizar cualquier acción. 
				Make sure you are sure you want to restore the security key before confirming it. </para>
			</warning>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="150" fileref="images/ch01_img040.png"/>
				</imageobject>
				<caption>
					<para>Submenu sensores IPS/IDS options: Stop Auto-apply y Recreate Private Key</para>
				</caption>
			</mediaobject>
		</section>	
		<section>
			<title>IPS/IDS Settings</title>
			<para>In this section we find the options available to configure the IPS/IDS sensors and the behavior of Snort and PF_RING.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img041.png"/>
				</imageobject>
				<caption>
					<para>Editable fields for IPS/IDS (IPS Settings)</para>
				</caption>
			</mediaobject>
			<para><literal>Sensor mode</literal></para>
			<para><literal>Default sensor mode</literal>: in this box will appear the mode that has been inherited from higher levels.
			In this case, the word INHERITED will appear followed, in parentheses, by the way it has been inherited.</para>
			<para>In this field, the user can choose between 4 different options:</para>		
			<orderedlist>
				<listitem>
					<para><emphasis role="bold">IDS forwarding:</emphasis> traffic is immediately forwarded by the sensor; then a copy of it is analyzed.
					In practice, it produces the same effect as having a TAP before the sensor.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">IDS span:</emphasis> only the traffic is analyzed. No forward is made.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">IPS test mode:</emphasis> the traffic is analyzed and subsequently forwarded. This mode is recommended for simulations of blocking attacker traffic.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">IPS:</emphasis> this is the most common option in production environments.
					Snort analyzes the traffic and passes or blocks the traffic depending on the actions set on the rules included in the sensor signature policy.</para>
				</listitem>			
			</orderedlist>
			<important>
				<title>Important</title>
				<para>The sensor must be configured in <emphasis role="bold">IPS Test or IPS mode</emphasis> for the basic scenario of installing redborder IPS.</para>
			</important>
			<para>Next, the user can edit a series of parameters related to the behavior of PF_RING and Snort:</para>
			<para><literal>PF_RING Watermark</literal></para>
			<para>Indicates the minimum number of incoming packets for the poll function.</para>
			<itemizedlist mark="bullet">	
				<listitem>		
					<para><emphasis>Low watermark value (1):</emphasis> reduces the latency of the poll function, decreases the throughtput, but may increase the number of calls to the poll function.</para>
				</listitem>
				<listitem>	
					<para><emphasis>High watermark value</emphasis> (should never exceed 50% of the ring size or else the PF_RING kernel module will increase this value): reduce the number of poll calls,
but slightly increases packet latency.</para>
				</listitem>
			</itemizedlist>
			<para><literal>PF_RING Clustermode</literal></para>
			<para>Split incoming traffic into multiple rings. Especially suitable for <emphasis role="bold"> distributing the load</emphasis> 
			by allowing the same interface to be read from several Snort programs.</para>
			<para>Indicates the number of parameters used to determine the hashing and balancing of the traffic between the different Snort processes.
			Depending on the number of elements that are added to the tuple, the traffic will be distributed in a different way:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>2 tuple flow: Source IP+Destination IP</para>
				</listitem>
				<listitem>
					<para>4 tuple flow: Source IP:Port_src+Destination IP:Port_dst</para>
				</listitem>
				<listitem>
					<para>5 tuple flow: Source IP:Port_src+Destination IP:Port_dst+protocol</para>
				</listitem>
				<listitem>
					<para>6 tuple flow: Source IP:Port_src+Destination IP:Port_dst+protocol+Vlan</para>
				</listitem>
			</itemizedlist>
			<para><literal>Bypass controlled by Snort</literal></para>
			<para>When the machine starts Snort can automatically take control of the bypasses.
			This action may cause unwanted firewall flapping to prevent Snort from being enabled for bypass control.</para>
			<para><literal>Threshold Count</literal></para>
			<para>Maximum number of occurrences in a given time range for an event to be sent.</para>
			<para><literal>Threshold Seconds</literal></para>
			<para>Minimum time (in seconds) that has to pass for an event to be sent.</para>
			<note>
				<title>Note</title>
				<para>In scenarios where there is an overload of traffic, it is possible make a configuration that allows connectivity over packet analysis.</para>
				<para>The options of <literal>Best effort Configuration</literal> and <literal>Software Bypass Configuration</literal> are used to prioritize forwarding information over analyzing it.</para>
			</note>
			<para><literal>Best effort Configuration</literal></para>
			<para>This setting only applies in <emphasis role="bold">IDS</emphasis> mode.</para>
			<para>By enabling this option, traffic is copied to an internal work queue and then forwarded.
Only if there are no more packets to be forward, the packets in the internal queue will be processed.
If the internal queue is full, the packets will not be analyzed. This increases the reliability of the bypass, but decreases the performance of the analysis. </para>
			<para><literal>Software Bypass Configuration</literal></para>
			<para>This setting only applies in <emphasis role="bold">IPS</emphasis> mode.</para>
			<para>The activation of this option implies that, if the occupation of the interface ring is high,
IPS will forward unanalyzed packets until occupancy falls below some other predetermined value.</para>
			<important>
				<title>Important</title>
				<para>IPS bypass configuration is done at the software level. To determine the configuration of the bypasses at the hardware level, refer to the section <literal>Segments.</literal></para>			
			</important>
		</section>	
		<section>
			<title>Servers</title>
			<para>In this section the user can define the configuration of the Proxy and Syslog servers.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img042.png"/>
				</imageobject>
				<caption>
					<para>Proxy and Syslog servers configuration</para>
				</caption>
			</mediaobject>
			<para>This section will show all its fields with the inherited configuration by the sensor. The user will be able to edit the following information: </para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>Syslog Servers</para>
				</listitem>
				<listitem>
					<para>Syslog protocol: UDP/TCP</para>
				</listitem>
				<listitem>
					<para>syslog mode: Basic/Extended</para>
				</listitem>
				<listitem>						
					<para>Enable proxy: Yes/No</para>
				</listitem>
			</itemizedlist>
		</section>
		<section>
			<title>Trap Servers</title>
			<para>In this section, the SNMP <literal>Trap Servers</literal> configuration is made.</para> 
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img043.png"/>
				</imageobject>
				<caption>
					<para>Trap Servers list</para>
				</caption>
			</mediaobject>
			<para><emphasis role="bold">Add Trap Server:</emphasis> It is possible to add a new <literal>Trap Server</literal> clicking on <literal>+Add.</literal>
			Next, enter the IP and the SNMP Community to which it belongs. <literal>Update</literal> to save the changes made.</para>		
			<para><emphasis role="bold">Delete Trap Server:</emphasis> Click on the "Delete" icon to discard the selected Trap Server.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img044.png"/>
				</imageobject>
				<caption>
					<para>Add new Trap Server</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Segments</title>
			<para>This section shows a list with the segments that have been created during the sensor registration process in the Manager.
The following information is displayed:</para>		
			<itemizedlist mark="bullet">
				<listitem>
					<para>Segment</para>
				</listitem>
				<listitem>
					<para>Interfaces</para>
				</listitem>
				<listitem>
					<para>Bypass: activate or deactivate the bypass function.</para>
				</listitem>
				<listitem>
					<para>Segment type</para>
				</listitem>
				<listitem>
					<para>Speed</para>
				</listitem>
			</itemizedlist> 
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img045.png"/>
				</imageobject>
				<caption>
					<para>Information about the sensor network segments</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Network routes</title>
			<para>Allows the configuration of additional routes that complement the default gateway.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img046.png"/>
				</imageobject>
				<caption>
					<para>Static network routes or Network Routes</para>
				</caption>
			</mediaobject>
			<para>It is possible to add a new route through the tab <literal>+Add Route.</literal> Next insert network and network gateway.</para>
			<mediaobject>
				<imageobject>	
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img047.png"/>
				</imageobject>
				<caption>
					<para>Add new network route: <literal>Network Route</literal></para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Location</title>
			<para>Locate the sensor or domain on a world map.</para>
			<para><emphasis role="bold">Add location:</emphasis> it is possible to add a location from the option <literal>+Add Location</literal> 
			and enter the coordinates, or through the menu displayed by the right mouse button.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img048.png"/>
				</imageobject>
				<caption>
					<para>Add sensor location: +Add Location</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img049.png"/>
				</imageobject>
				<caption>
					<para>Add sensor location: right click menu</para>
				</caption>
			</mediaobject>
			<warning>
				<title>Warning</title>
				<para>To be able to display data in the view <literal>Maps</literal> it is necessary to add the locations of the sensors in this interface.</para>
			</warning>
		</section>
		<section>
			<title>IP Variables</title> 
			<para>This section shows the values ​​for the Snort IP variables.</para>
			<para>Some Snort variables must be modified (edited) to suit the user's network infrastructure so that Snort can recognize them.
For example, in the event that local networks with public IPs have been configured.</para>
			<para>Those IP variables inherited from a higher level will appear with a check in the box <literal> Inherited.</literal></para>
			<para><emphasis role="bold">Available actions:</emphasis> export, import, edit and delete IP variables.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img050.png"/>
				</imageobject>
				<caption>
					<para>IP variables</para>
				</caption>
			</mediaobject>
			<note>
				<title>Note</title>
				<para>For more information about the values ​​of the IP variables see the following link: http://manual.snort.org/node53.html</para>
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img051.png"/>
				</imageobject>
				<caption>
					<para>Edit IP Variable values</para>
				</caption>
			</mediaobject>
			<para>It is possible to Export and import IP variables from the tabs <literal>Export</literal> and <literal>Import.</literal> The file format used in the import and export must be .csv</para>
			<para>La opción de importación de variables ofrece la posibilidad de Añadir variables o reemplazar las existentes.</para>
			<warning>
				<title>Warning</title>
				<para>In case of selecting the option Import variables -> <literal>Replace variables,</literal> 
				the new variables will override the values ​​shown in the list if the variable already existed and was not inherited.</para>
			</warning>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img052.png"/>
				</imageobject>
				<caption>
					<para>Import IP variables</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img053.png"/>
				</imageobject>
				<caption>
					<para>Export IP variables</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Port variables</title>
			<para>This section shows the values ​​for the Snort port variables.</para>
			<para>The values ​​of these variables can also be edited in exceptional cases where non-conventional ports have been defined. 
			In this way, Snort will be able to recognize these variables. Those that are inherited from a higher level will have the box <literal> Inherited</literal>  activated.</para>
			<para><emphasis role="bold">Available actions:</emphasis> export, import, edit and delete port variables. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img054.png"/>
				</imageobject>
				<caption>
					<para>Port variables</para>
				</caption>
			</mediaobject>
			<note>
				<title>Note</title>
				<para>For more information about the values ​​of the Snort port variables, consult the following link: http://manual.snort.org/node54.html</para>
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img055.png"/>
				</imageobject>
				<caption>
					<para>Edit Snort Port Variable Values</para>
				</caption>
			</mediaobject>
			<para>It is possible to Export and import port variables from the tabs <literal>Export</literal> and <literal>Import.</literal> The file format used in the import and export must be .csv</para>
			<para>The import variables option offers the possibility to Add variables or replace existing ones.</para>
			<warning>
				<title>Warning</title>
				<para>In case of selecting the option Import variables-> <literal>Replace variables</literal> the new variables will override the values ​​shown in the list in case the variable already existed and this one,
was not inherited.</para>
			</warning>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img056.png"/>
				</imageobject>
				<caption>
					<para>Import snort port variables</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch01_img057.png"/>
				</imageobject>
				<caption>
					<para>Export snort port variables</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Groups</title>
			<para><emphasis role="bold">Group:</emphasis> it is a set of instances associated with a specific processor that read from one or more segments in a specific way.</para>
			<para><emphasis role="bold">Instance:</emphasis> it is an association of a group of segments to a processor or processors. In case we have created more than one instance for the same group, 
			it is necessary to have the same number of bindings configured as instances.</para>
			<para><emphasis role="bold">Binding</emphasis> it is a partition of the traffic by network or VLAN. It is a "child" of a group of segments.</para>
			<para>The user can assign a policy at three levels: sensor, group of segments or bindings.</para>
			<para>This increases the flexibility associated with the software, since, unlike the previous version in which a policy had to be fully applied for a sensor (regardless of the segments created),
allows the formation of groups of independent segments and bindings.</para>
			<note>
				<title>Note</title>
				<para><emphasis role="bold">The inheritance system is established from the higher levels and will apply to the lower levels that hang from it.</emphasis></para>
				<para>Configuration parameters and policies of higher levels affect those "children" that hang or depend on them. In case the configuration of said children is not edited,
the system will assign by default the policies, modes and configurations assigned to the "parent" level.</para> 	
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img058.png"/>
				</imageobject>
				<caption>
					<para>Segments groups</para>
				</caption>
			</mediaobject>
			<para>In this section you can configure the segment groups:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold">Name:</emphasis> edit group name</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Sensor mode:</emphasis> selection of the mode to be applied at the group level (sensor mode is inherited by default)</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Segments:</emphasis> indicates the segment(s) included in the group</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">CPUs:</emphasis> assignment of the processor(s) from which the group of segments is to be read.</para>
				</listitem>
			</itemizedlist>
			<important>
				<title>Important</title>
				<para>When there is more than one group of segments, it is recommended that different processors or CPUs be assigned to each group to distribute the processes and on that way balance the load of each processor.</para>
			</important>
			<section>
				<title>Conditions for creating segment groups</title>
				<itemizedlist mark="bullet">
					<listitem>
						<para>It is not possible for two groups to share the same segments.</para>
					</listitem>
					<listitem>
						<para>Two instances of the same group cannot have different modes <literal>(Sensor mode).</literal></para>
					</listitem>
					<listitem>
						<para>IPS/IDS sensors: they can only hang from them their own groups and bindings.</para>
					</listitem>
					<listitem>
						<para>Groups and links can be moved and make then domain dependent. However, these can only be returned to the IPS sensor they belonged to before being moved.</para>
					</listitem>
				</itemizedlist>
			</section>
			<section>
				<title>Add/Edit Segment Group</title>
				<para>To add a new group, simply select the option <literal>+Add Group.</literal></para>
				<para>To edit an existing group, click on the "Edit" icon.</para>
				<para>In both cases, the user will access the configuration interface at the group level. In it you can modify the following information:</para>
				<itemizedlist mark="bullet">
					<listitem>
						<para><emphasis role="bold">Name:</emphasis> edit group name </para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Description:</emphasis> add a description to the segment group.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">IPS/IDS Settings:</emphasis> configuring Snort parameters at the group level.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">IP Variables:</emphasis> list of values ​​for the Snort IP variables at the group level. 
				Some Snort variables must be modified (edited) to suit the user's network infrastructure so that Snort can recognize them.
Those that are inherited from a higher level will appear with a check in the <literal>Inherited</literal> box.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Port Variables:</emphasis> This section shows the values ​​for Snort ports variables at the group level.
The values ​​of these variables can also be edited in exceptional cases where non-conventional ports have been defined.
				In this way, Snort will be able to recognize these variables. Those that are inherited from a higher level will appear marked as <literal> Inherited.</literal></para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Bindings:</emphasis> bindings are partitions of traffic across networks or VLANs. They act as "children" of the group at the level of inheritance and application of policies. 
					To add a new binding click on <literal>+Add binding</literal> and enter the name.</para>
					</listitem>
				</itemizedlist>
				<note>
					<title>Note</title>
					<para>Remember that the segment group will display the settings it has inherited from the sensor. This is the one that will be shown by default in the editing screen at the group level.</para>
				</note>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img059.png"/>
					</imageobject>
					<caption>
						<para>Add/edit segment group</para>
					</caption>
				</mediaobject>
					<para><emphasis role="bold">Delete a segment group</emphasis></para>
					<para>A group can be deleted at any time using the "Delete" icon. The system will display a confirmation message.</para>
				<important>
					<title>Important</title>
					<para>In case that a group had a series of policies assigned, when the group is deleted, these will no longer be applied to the segments that belonged to the group.
The segments will be free for integration into another group. </para>
				</important>
			</section>
			<section>
				<title>Delete a segment group</title>
				<para>A group can be deleted at any time using the "Delete" icon. The system will display a confirmation message.</para>
					<important>
					<title>Important</title>
					<para>In case that a group had a series of policies assigned, when the group is deleted, these will no longer be applied to the segments that belonged to the group.
The segments will be free for integration into another group.</para>
				</important>
			</section>
			<section>
				<title>Bindings</title>
					<para><emphasis role="bold">Add/edit binding configuration</emphasis></para>
					<para>There are two ways to add or edit a binding:</para>
					<orderedlist numeration="arabic">
					<listitem>
						<para>IPS/IDS sensor configuration view: Groups -> Edit icon -> Bindings-> <literal>+ Add binding</literal>/Edit icon</para>
					</listitem>
					<listitem>
						<para>IPS/IDS sensor configuration view: <literal>+ Add Group</literal> -> Bindings -> <literal>+ Add binding</literal>/Edit icon</para>
					</listitem>
				</orderedlist>
				<para>When we add a new binding the system prompts us for a name.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img060.png"/>
					</imageobject>
					<caption>
						<para>Segments groups -> Bindings</para>
					</caption>
				</mediaobject>
				<note>
					<title>Note</title>
					<para>For a binding to be taken into account, at least one Vlan must be assigned to it.</para>
				</note>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img061.png"/>
					</imageobject>
					<caption>
						<para>Edit binding configuration</para>
					</caption>
				</mediaobject>
				<para>The editing fields for the binding level configuration are the following:</para>
				<itemizedlist>
					<listitem>
						<para>General: Name and description.</para>
					</listitem>
					<listitem>
						<para>IPS/IDS Settings</para>
					</listitem>
					<listitem>
						<para>IP Variables</para>
					</listitem>
					<listitem>
						<para>Port Variables</para>
					</listitem>
				</itemizedlist>
				<para>To ensure that modifications made to an existing binding will be applied correctly, click on <literal>Update</literal></para>
				<warning>
					<title>Warning</title>
					<para>If the IPS/IDS Settings, IP Variables and Port Variables fields are not modified, the binding will inherit the configuration of the group of segments on which it depends.</para>
				</warning>
			</section>
		</section>
	 </section>
	 <section>
		<title>Inherit policies</title>
		<para>As we have seen before, the organization of network elements created in redborder is hierarchical and therefore establishes dependencies between levels and others.</para>
		<para>These dependencies establish an inheritance system that affects both the configuration and the policies applied at each of the levels (from higher to lower hierarchy):</para>
		<itemizedlist>
			<listitem>
				<para>Root</para>
			</listitem>
			<listitem>
				<para>Domain</para>
			</listitem>
			<listitem>
				<para>Sensors</para>
			</listitem>
			<listitem>
				<para>Group</para>
			</listitem>
			<listitem>
				<para>Binding</para>
			</listitem>
		</itemizedlist>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img062.png"/>
			</imageobject>
			<caption>
				<para>Sensors -> Tree: hierarchies and dependencies between levels</para>
	 		</caption>
		</mediaobject>	
		<note>
			<title>Note</title>
			<para>The inheritance system establishes that the configuration of higher levels affects that of those "children" that hang or depend on them. In case the configuration of said children is not edited,
the system will assign by default the policies, modes and configurations assigned to the "parent" level.
			<emphasis role="bold">The inheritance system is therefore established from the higher levels and will apply to the lower levels that hang from it.</emphasis></para>
		</note>
		<para><emphasis role="bold">General Settings</emphasis></para>
		<para>In <literal>Tools</literal> section we found the option <literal>General Settings</literal> from which the user can establish the configuration of the general parameters of the Manager.</para>
		<para>This is the highest level of configuration (<emphasis role="bold">root</emphasis> domain) so the properties defined here will be inherited by the rest of the domains and sensors that are below this level.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img063.png"/>
			</imageobject>
			<caption>
				<para>General Settings: General Manager configuration or "root"</para>
	 		</caption>
		</mediaobject>
		<para><emphasis role="bold">Inherited setting: "Inherited"</emphasis></para>	
		<para>When a domain or sensor is created or edited for the first time, we will notice that some parameters are accompanied by the label 
		<emphasis role="bold">"Inherited"</emphasis>, this means that they have inherited the values ​​inherited from the general configuration of the Manager
or of the domains or sensors that are above the newly created element.
To change this setting, the user will need to override that information.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch01_img064.png"/>
			</imageobject>
			<caption>
				<para>Inherited IPS/IDS sensor configuration</para>
	 		</caption>
		</mediaobject>
    </section>	
</chapter>		
