<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2023">
<!ENTITY HOLDER "Eneo TecnologÃ­a S.L. |">
]>
<chapter>
	<title>Editing and configuring IPS/IDS sensors from the web application</title>
	<section>
        <title>IPS/IDS sensors configuration</title>
        <para>To configure the IPS/IDS sensors, it is necessary to access the redborder web platform by inserting the management IP assigned to the Manager in the address bar of your browser.</para>
        <para><screen>https://IP-manager-address</screen></para>
        <note>
            <title>Note</title>
            <para>It is possible to log in to the platform using the default account: <emphasis role="bold">admin or admin@redborder.com</emphasis>
            with the password used during the Manager installation process.</para>
        </note>
        <warning>
            <title>Warning</title>
            <para>The management web will not work if you try to access it through an unencrypted web.</para>
        </warning>
        <para>There are three ways to access the edition of the IPS/IDS sensors for the configuration of their operating parameters:</para>
        <itemizedlist mark="bullet">
            <listitem>
                <para><emphasis role="bold">Tree view:</emphasis> in the tree view, the user can see the IPS/IDS sensors that have been created, accompanied by an identification icon. 
                Click on the sensor name or press the <literal>"Edit"</literal> button to access to the sensor configuration view</para>
                <mediaobject>
                    <imageobject>
                        <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img037.png"/>
                    </imageobject>
                    <caption>
                        <para>Tree view: edit IPS/IDS sensor</para>
                    </caption>
                </mediaobject>
            </listitem>
            <listitem>
                <para><emphasis role="bold">Access Points view:</emphasis> the Access Points view show a list of APs defined on the network. 
                Click on an Access Point to access the interface configuration for general sensor parameters. </para>
                <mediaobject>
                    <imageobject>
                        <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img038.png"/>
                    </imageobject>
                    <caption>
                        <para>Access Points view: edit IPS/IDS sensor</para>
                    </caption>
                </mediaobject>
            </listitem>
            <listitem>
                <para><emphasis role="bold">IPS specific view:</emphasis> on the <literal>View</literal> there are specific views for each type of sensor.
                Select <literal>IPS sensors</literal> to access the alphabetical list of IPS sensors. Click the "Edit" icon.</para>
                <mediaobject>
                    <imageobject>
                        <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img039.png"/>
                    </imageobject>
                    <caption>
                        <para>IPS Sensors view: IPS/IDS</para>
                    </caption>
                </mediaobject>
            </listitem>
        </itemizedlist>
    
        <section>
            <title>Edit IPS/IDS settings overview</title>
            <para>In all the cases described, the user accesses to a basic parameters configuration view. </para>
            <para>The configuration form fields vary depending on whether you are editing a sensor, group of segments or binding.
            This step is very important since one configuration or another will determine the sensor's operating mode depending on whether it is installed in one scenario or another. 
            These options are defined in the section <emphasis role="bold">IPS/IDS configuration.</emphasis></para>
            <para>The fields displayed on the IPS sensor configuration form are listed below:</para>
            <itemizedlist mark="bullet">
                <listitem>
                    <para>General: displays general sensor information. The only editable information in this section is the description.
                    <footnote><para>Both the IP and the name of the sensor have been defined during the process of installing and registering the sensors in the Manager.</para></footnote></para>
                </listitem>
                <listitem>
                    <para>IPS/IDS Settings</para>
                </listitem>
                <listitem>
                    <para>Servers</para>
                </listitem>
                <listitem>
                    <para>Trap servers</para>
                </listitem>
                <listitem>
                    <para>Segments</para>
                </listitem>
                <listitem>
                    <para>Network routes</para>
                </listitem>
                <listitem>
                    <para>Location</para>
                </listitem>
                <listitem>
                    <para>IP Variables</para>
                </listitem>
                <listitem>
                    <para>Port variables</para>
                </listitem>
                <listitem>
                    <para>Groups</para>
                </listitem>
            </itemizedlist>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img039.png"/>
                </imageobject>
                <caption>
                    <para>Editable information for IDS/IPS sensor configuration</para>
                </caption>
            </mediaobject>
            <para>In the upper right corner of the screen we find the following options:</para> 
            <itemizedlist mark="bullet">
                <listitem>
                    <para><literal>Stop Auto-apply</literal></para>
                    <para>This button prevents Chef from automatically applying the changes (it refreshes and applies every 5 minutes).</para>
                    <para>The system will open a confirmation window to make sure that this is the action the user wants to perform.</para>
                </listitem>
                <listitem>
                    <para><literal>Options-> Recreate Private Key</literal></para>
                    <para>This option regenerates the synchronization private key of the IPS sensor with the Manager. If you have Administrator role in redborder,
    You will also find this option in the user editing interface in <literal>Tools -> Users</literal>.</para>
                    <para>Once said restoration has been confirmed, the user must enter the text that is shown in the modal window in the IPS in the following path:: 
                    <computeroutput>/etc/chef/client.pem</computeroutput></para>
                </listitem>
            </itemizedlist>
            <warning>
                <title>Warning</title>
                <para><emphasis role="bold">The action of restoring the private key is very sensitive since it can leave the sensor without communication with the Manager.</emphasis> Therefore, the system opens a confirmation window before performing any action. 
                Make sure you are sure you want to restore the security key before confirming it. </para>
            </warning>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="150" fileref="images/ch03_img040.png"/>
                </imageobject>
                <caption>
                    <para>Submenu sensores IPS/IDS options: Stop Auto-apply and Recreate Private Key</para>
                </caption>
            </mediaobject>
        </section>	
        <section>
            <title>IPS/IDS Settings</title>
            <para>In this section we find the options available to configure the IPS/IDS sensors and the behavior of Snort and PF_RING.</para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img041.png"/>
                </imageobject>
                <caption>
                    <para>Editable fields for IPS/IDS (IPS Settings)</para>
                </caption>
            </mediaobject>
            <para><literal>Sensor mode</literal></para>
            <para><literal>Default sensor mode</literal>: in this box will appear the mode that has been inherited from higher levels.
            In this case, the word INHERITED will appear followed, in parentheses, by the way it has been inherited.</para>
            <para>In this field, the user can choose between 4 different options:</para>		
            <orderedlist>
                <listitem>
                    <para><emphasis role="bold">IDS forwarding:</emphasis> traffic is immediately forwarded by the sensor; then a copy of it is analyzed.
                    In practice, it produces the same effect as having a TAP before the sensor.</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">IDS span:</emphasis> only the traffic is analyzed. No forward is made.</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">IPS test mode:</emphasis> the traffic is analyzed and subsequently forwarded. This mode is recommended for simulations of blocking attacker traffic.</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">IPS:</emphasis> this is the most common option in production environments.
                    Snort analyzes the traffic and passes or blocks the traffic depending on the actions set on the rules included in the sensor signature policy.</para>
                </listitem>			
            </orderedlist>
            <important>
                <title>Important</title>
                <para>The sensor must be configured in <emphasis role="bold">IPS Test or IPS mode</emphasis> for the basic scenario of installing redborder IPS.</para>
            </important>
            <para>Next, the user can edit a series of parameters related to the behavior of PF_RING and Snort:</para>
            <para><literal>PF_RING Watermark</literal></para>
            <para>Indicates the minimum number of incoming packets for the poll function.</para>
            <itemizedlist mark="bullet">	
                <listitem>		
                    <para><emphasis>Low watermark value (1):</emphasis> reduces the latency of the poll function, decreases the throughtput, but may increase the number of calls to the poll function.</para>
                </listitem>
                <listitem>	
                    <para><emphasis>High watermark value</emphasis> (should never exceed 50% of the ring size or else the PF_RING kernel module will increase this value): reduce the number of poll calls,
    but slightly increases packet latency.</para>
                </listitem>
            </itemizedlist>
            <para><literal>PF_RING Clustermode</literal></para>
            <para>Split incoming traffic into multiple rings. Especially suitable for <emphasis role="bold"> distributing the load</emphasis> 
            by allowing the same interface to be read from several Snort programs.</para>
            <para>Indicates the number of parameters used to determine the hashing and balancing of the traffic between the different Snort processes.
            Depending on the number of elements that are added to the tuple, the traffic will be distributed in a different way:</para>
            <itemizedlist mark="bullet">
                <listitem>
                    <para>2 tuple flow: Source IP+Destination IP</para>
                </listitem>
                <listitem>
                    <para>4 tuple flow: Source IP:Port_src+Destination IP:Port_dst</para>
                </listitem>
                <listitem>
                    <para>5 tuple flow: Source IP:Port_src+Destination IP:Port_dst+protocol</para>
                </listitem>
                <listitem>
                    <para>6 tuple flow: Source IP:Port_src+Destination IP:Port_dst+protocol+Vlan</para>
                </listitem>
            </itemizedlist>
            <para><literal>Bypass controlled by Snort</literal></para>
            <para>When the machine starts Snort can automatically take control of the bypasses. This action will allow the system to switch off the bypass after a boot process.</para>
            <para><literal>Threshold Count</literal></para>
            <para>Maximum number of occurrences in a given time range for an event to be sent.</para>
            <para><literal>Threshold Seconds</literal></para>
            <para>Minimum time (in seconds) that has to pass for an event to be sent.</para>
            <note>
                <title>Note</title>
                <para>In scenarios where there is an overload of traffic, it is possible make a configuration that allows connectivity over packet analysis.</para>
                <para>The options of <literal>Best effort Configuration</literal> and <literal>Software Bypass Configuration</literal> are used to prioritize forwarding information over analyzing it.</para>
            </note>
            <para><literal>Best effort Configuration</literal></para>
            <para>This setting only applies in <emphasis role="bold">IDS</emphasis> mode.</para>
            <para>By enabling this option, traffic is copied to an internal work queue and then forwarded.
    Only if there are no more packets to be forward, the packets in the internal queue will be processed.
    If the internal queue is full, the packets will not be analyzed. This increases the reliability of the bypass, but decreases the performance of the analysis. </para>
            <para><literal>Software Bypass Configuration</literal></para>
            <para>This setting only applies in <emphasis role="bold">IPS</emphasis> mode.</para>
            <para>The activation of this option implies that, if the occupation of the interface ring is high,
    IPS will forward unanalyzed packets until occupancy falls below some other predetermined value.</para>
            <important>
                <title>Important</title>
                <para>IPS bypass configuration is done at the software level. To determine the configuration of the bypasses at the hardware level, refer to the section <literal>Segments.</literal></para>			
            </important>
        </section>	
        <section>
            <title>Servers</title>
            <para>In this section the user can define the configuration of the Proxy and Syslog servers.</para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img042.png"/>
                </imageobject>
                <caption>
                    <para>Proxy and Syslog servers configuration</para>
                </caption>
            </mediaobject>
            <para>This section will show all its fields with the inherited configuration by the sensor. The user will be able to edit the following information: </para>
            <itemizedlist mark="bullet">
                <listitem>
                    <para>Syslog Servers</para>
                </listitem>
                <listitem>
                    <para>Syslog protocol: UDP/TCP</para>
                </listitem>
                <listitem>
                    <para>syslog mode: Basic/Extended</para>
                </listitem>
                <listitem>						
                    <para>Enable proxy: Yes/No</para>
                </listitem>
            </itemizedlist>
        </section>
        <section>
            <title>Trap Servers</title>
            <para>In this section, the SNMP <literal>Trap Servers</literal> configuration is made.</para> 
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img043.png"/>
                </imageobject>
                <caption>
                    <para>Trap Servers list</para>
                </caption>
            </mediaobject>
            <para><emphasis role="bold">Add Trap Server:</emphasis> It is possible to add a new <literal>Trap Server</literal> clicking on <literal>+Add.</literal>
            Next, enter the IP and the SNMP Community to which it belongs. <literal>Update</literal> to save the changes made.</para>		
            <para><emphasis role="bold">Delete Trap Server:</emphasis> Click on the "Delete" icon to discard the selected Trap Server.</para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img044.png"/>
                </imageobject>
                <caption>
                    <para>Add new Trap Server</para>
                </caption>
            </mediaobject>
        </section>
        <section>
            <title>Segments</title>
            <para>This section shows a list with the segments that have been created during the sensor registration process in the Manager.
    The following information is displayed:</para>		
            <itemizedlist mark="bullet">
                <listitem>
                    <para>Segment</para>
                </listitem>
                <listitem>
                    <para>Interfaces</para>
                </listitem>
                <listitem>
                    <para>Bypass: activate or deactivate the bypass function.</para>
                </listitem>
                <listitem>
                    <para>Segment type</para>
                </listitem>
                <listitem>
                    <para>Speed</para>
                </listitem>
            </itemizedlist> 
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img045.png"/>
                </imageobject>
                <caption>
                    <para>Information about the sensor network segments</para>
                </caption>
            </mediaobject>
        </section>
        <section>
            <title>Network routes</title>
            <para>Allows the configuration of additional routes that complement the default gateway.</para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img046.png"/>
                </imageobject>
                <caption>
                    <para>Static network routes or Network Routes</para>
                </caption>
            </mediaobject>
            <para>It is possible to add a new route through the tab <literal>+Add Route.</literal> Next insert network and network gateway.</para>
            <mediaobject>
                <imageobject>	
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img047.png"/>
                </imageobject>
                <caption>
                    <para>Add new network route: <literal>Network Route</literal></para>
                </caption>
            </mediaobject>
        </section>
        <section>
            <title>Location</title>
            <para>Locate the sensor or domain on a world map.</para>
            <para><emphasis role="bold">Add location:</emphasis> it is possible to add a location from the option <literal>+Add Location</literal> 
            and enter the coordinates, or through the menu displayed by the right mouse button.</para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img048.png"/>
                </imageobject>
                <caption>
                    <para>Add sensor location: +Add Location</para>
                </caption>
            </mediaobject>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img049.png"/>
                </imageobject>
                <caption>
                    <para>Add sensor location: right click menu</para>
                </caption>
            </mediaobject>
            <warning>
                <title>Warning</title>
                <para>To be able to display data in the view <literal>Maps</literal> it is necessary to add the locations of the sensors in this interface.</para>
            </warning>
        </section>
        <section>
            <title>IP Variables</title> 
            <para>This section shows the values ââfor the Snort IP variables.</para>
            <para>Some Snort variables must be modified (edited) to suit the user's network infrastructure so that Snort can recognize them.
    For example, in case that local networks with public IPs have been configured.</para>
            <para>Those IP variables inherited from a higher level will appear with a check in the box <literal> Inherited.</literal></para>
            <para><emphasis role="bold">Available actions:</emphasis> export, import, edit and delete IP variables.</para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img050.png"/>
                </imageobject>
                <caption>
                    <para>IP variables</para>
                </caption>
            </mediaobject>
            <note>
                <title>Note</title>
                <para>For more information about the values ââof the IP variables see the following link: http://manual.snort.org/node53.html</para>
            </note>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img051.png"/>
                </imageobject>
                <caption>
                    <para>Edit IP Variable values</para>
                </caption>
            </mediaobject>
            <para>It is possible to Export and import IP variables from the tabs <literal>Export</literal> and <literal>Import.</literal> The file format used in the import and export must be .csv</para>
            <para>The variable import option offers the possibility to Add variables or replace existing ones.</para>
            <warning>
                <title>Warning</title>
                <para>In case of selecting the option Import variables -> <literal>Replace variables,</literal> 
                the new variables will override the values ââshown in the list if the variable already existed and was not inherited.</para>
            </warning>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img052.png"/>
                </imageobject>
                <caption>
                    <para>Import IP variables</para>
                </caption>
            </mediaobject>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img053.png"/>
                </imageobject>
                <caption>
                    <para>Export IP variables</para>
                </caption>
            </mediaobject>
        </section>
        <section>
            <title>Port variables</title>
            <para>This section shows the values ââfor the Snort port variables.</para>
            <para>The values ââof these variables can also be edited in exceptional cases where non-conventional ports have been defined. 
            In this way, Snort will be able to recognize these variables. Those that are inherited from a higher level will have the box <literal> Inherited</literal>  activated.</para>
            <para><emphasis role="bold">Available actions:</emphasis> export, import, edit and delete port variables. </para>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img054.png"/>
                </imageobject>
                <caption>
                    <para>Port variables</para>
                </caption>
            </mediaobject>
            <note>
                <title>Note</title>
                <para>For more information about the values ââof the Snort port variables, consult the following link: http://manual.snort.org/node54.html</para>
            </note>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img055.png"/>
                </imageobject>
                <caption>
                    <para>Edit Snort Port Variable Values</para>
                </caption>
            </mediaobject>
            <para>It is possible to Export and import port variables from the tabs <literal>Export</literal> and <literal>Import.</literal> The file format used in the import and export must be .csv</para>
            <para>The import variables option offers the possibility to Add variables or replace existing ones.</para>
            <warning>
                <title>Warning</title>
                <para>In case of selecting the option Import variables-> <literal>Replace variables</literal> the new variables will override the values ââshown in the list in case the variable already existed and this one,
    was not inherited.</para>
            </warning>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img056.png"/>
                </imageobject>
                <caption>
                    <para>Import snort port variables</para>
                </caption>
            </mediaobject>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="350" fileref="images/ch03_img057.png"/>
                </imageobject>
                <caption>
                    <para>Export snort port variables</para>
                </caption>
            </mediaobject>
        </section>
        <section>
            <title>Groups</title>
            <para><emphasis role="bold">Group:</emphasis> it is a set of instances associated with a specific processor that read from one or more segments in a specific way.</para>
            <para><emphasis role="bold">Instance:</emphasis> it is an association of a group of segments to a processor or processors. In case we have created more than one instance for the same group, 
            it is necessary to have the same number of bindings configured as instances.</para>
            <para><emphasis role="bold">Binding</emphasis> it is a partition of the traffic by network or VLAN. It is a "child" of a group of segments.</para>
            <para>The user can assign a policy at three levels: sensor, group of segments or bindings.</para>
            <para>This increases the flexibility associated with the software, since, unlike the previous version in which a policy had to be fully applied for a sensor (regardless of the segments created),
    allows the formation of groups of independent segments and bindings.</para>
            <note>
                <title>Note</title>
                <para><emphasis role="bold">The inheritance system is established from the higher levels and will apply to the lower levels that are derived from it.</emphasis></para>
                <para>Configuration parameters and policies of higher levels affect those "children" that are derived or depend on them. In case the configuration of said children is not edited,
    the system will assign by default the policies, modes and configurations assigned to the "parent" level.</para> 	
            </note>
            <mediaobject>
                <imageobject>
                    <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img058.png"/>
                </imageobject>
                <caption>
                    <para>Segments groups</para>
                </caption>
            </mediaobject>
            <para>In this section you can configure the segment groups:</para>
            <itemizedlist mark="bullet">
                <listitem>
                    <para><emphasis role="bold">Name:</emphasis> edit group name</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">Sensor mode:</emphasis> selection of the mode to be applied at the group level (sensor mode is inherited by default)</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">Segments:</emphasis> indicates the segment(s) included in the group</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">CPUs:</emphasis> assignment of the processor(s) from which the group of segments is to be read.</para>
                </listitem>
            </itemizedlist>
            <important>
                <title>Important</title>
                <para>When there is more than one group of segments, it is recommended that different processors or CPUs be assigned to each group to distribute the processes and on that way balance the load of each processor.</para>
            </important>
        
            <section>
                <title>Conditions for creating segment groups</title>
                <itemizedlist mark="bullet">
                    <listitem>
                        <para>It is not possible for two groups to share the same segments.</para>
                    </listitem>
                    <listitem>
                        <para>Two instances of the same group cannot have different modes <literal>(Sensor mode).</literal></para>
                    </listitem>
                    <listitem>
                        <para>IPS/IDS sensors: they can only be derived from their own groups and bindings.</para>
                    </listitem>
                    <listitem>
                        <para>Groups and links can be moved and make them domain dependent. However, these can only be returned to the IPS sensor they belonged to before being moved.</para>
                    </listitem>
                </itemizedlist>
            </section>
            <section>
                <title>Add/Edit Segment Group</title>
                <para>To add a new group, simply select the option <literal>+Add Group.</literal></para>
                <para>To edit an existing group, click on the "Edit" icon.</para>
                <para>In both cases, the user will access the configuration interface at the group level. In it you can modify the following information:</para>
                <itemizedlist mark="bullet">
                    <listitem>
                        <para><emphasis role="bold">Name:</emphasis> edit group name </para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Description:</emphasis> add a description to the segment group.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">IPS/IDS Settings:</emphasis> configuring Snort parameters at the group level.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">IP Variables:</emphasis> list of values ââfor the Snort IP variables at the group level. 
                Some Snort variables must be modified (edited) to suit the user's network infrastructure so that Snort can recognize them.
        Those that are inherited from a higher level will appear with a check in the <literal>Inherited</literal> box.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Port Variables:</emphasis> This section shows the values ââfor Snort ports variables at the group level.
        The values ââof these variables can also be edited in exceptional cases where non-conventional ports have been defined.
                In this way, Snort will be able to recognize these variables. Those that are inherited from a higher level will appear marked as <literal> Inherited.</literal></para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Bindings:</emphasis> bindings are partitions of traffic across networks or VLANs. They act as "children" of the group at the level of inheritance and application of policies. 
                    To add a new binding click on <literal>+Add binding</literal> and enter the name.</para>
                    </listitem>
                </itemizedlist>
                <note>
                    <title>Note</title>
                    <para>Remember that the segment group will display the settings it has inherited from the sensor. This is the one that will be shown by default in the editing screen at the group level.</para>
                </note>
                <mediaobject>
                    <imageobject>
                        <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img059.png"/>
                    </imageobject>
                    <caption>
                        <para>Add/edit segment group</para>
                    </caption>
                </mediaobject>
                    <para><emphasis role="bold">Delete a segment group</emphasis></para>
                    <para>A group can be deleted at any time using the "Delete" icon. The system will display a confirmation message.</para>
                <important>
                    <title>Important</title>
                    <para>In case that a group had a series of policies assigned, when the group is deleted, these will no longer be applied to the segments that belonged to the group.
        The segments will be free for integration into another group. </para>
                </important>
            </section>
            <section>
                <title>Delete a segment group</title>
                <para>A group can be deleted at any time using the "Delete" icon. The system will display a confirmation message.</para>
                    <important>
                    <title>Important</title>
                    <para>In case that a group had a series of policies assigned, when the group is deleted, these will no longer be applied to the segments that belonged to the group.
        The segments will be free for integration into another group.</para>
                </important>
            </section>
            <section>
                <title>Bindings</title>
                    <para><emphasis role="bold">Add/edit binding configuration</emphasis></para>
                    <para>There are two ways to add or edit a binding:</para>
                    <orderedlist numeration="arabic">
                    <listitem>
                        <para>IPS/IDS sensor configuration view: Groups -> Edit icon -> Bindings-> <literal>+ Add binding</literal>/Edit icon</para>
                    </listitem>
                    <listitem>
                        <para>IPS/IDS sensor configuration view: <literal>+ Add Group</literal> -> Bindings -> <literal>+ Add binding</literal>/Edit icon</para>
                    </listitem>
                </orderedlist>
                <para>When we add a new binding the system prompts us for a name.</para>
                <mediaobject>
                    <imageobject>
                        <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img060.png"/>
                    </imageobject>
                    <caption>
                        <para>Segments groups -> Bindings</para>
                    </caption>
                </mediaobject>
                <note>
                    <title>Note</title>
                    <para>For a binding to be taken into account, at least one Vlan must be assigned to it.</para>
                </note>
                <mediaobject>
                    <imageobject>
                        <imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img061.png"/>
                    </imageobject>
                    <caption>
                        <para>Edit binding configuration</para>
                    </caption>
                </mediaobject>
                <para>The editing fields for the binding level configuration are the following:</para>
                <itemizedlist>
                    <listitem>
                        <para>General: Name and description.</para>
                    </listitem>
                    <listitem>
                        <para>IPS/IDS Settings</para>
                    </listitem>
                    <listitem>
                        <para>IP Variables</para>
                    </listitem>
                    <listitem>
                        <para>Port Variables</para>
                    </listitem>
                </itemizedlist>
                <para>To ensure that modifications made to an existing binding will be applied correctly, click on <literal>Update</literal></para>
                <warning>
                    <title>Warning</title>
                    <para>If the IPS/IDS Settings, IP Variables and Port Variables fields are not modified, the binding will inherit the configuration of the group of segments on which it depends.</para>
                </warning>
            </section>
        </section>
    </section>
	<section>
		<title>Inherit policies</title>
		<para>As we have seen before, the organization of network elements created in redborder is hierarchical and therefore establishes dependencies between levels and others.</para>
		<para>These dependencies establish an inheritance system that affects both the configuration and the policies applied at each of the levels (from higher to lower hierarchy):</para>
		<itemizedlist>
			<listitem>
				<para>Root</para>
			</listitem>
			<listitem>
				<para>Domain</para>
			</listitem>
			<listitem>
				<para>Sensors</para>
			</listitem>
			<listitem>
				<para>Group</para>
			</listitem>
			<listitem>
				<para>Binding</para>
			</listitem>
		</itemizedlist>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img062.png"/>
			</imageobject>
			<caption>
				<para>Sensors -> Tree: hierarchies and dependencies between levels</para>
	 		</caption>
		</mediaobject>	
		<note>
			<title>Note</title>
			<para>The inheritance system establishes that the configuration of higher levels affects that of those "children" that are derived or depend on them. In case the configuration of said children is not edited,
the system will assign by default the policies, modes and configurations assigned to the "parent" level.
			<emphasis role="bold">The inheritance system is therefore established from the higher levels and will apply to the lower levels that are derived from it.</emphasis></para>
		</note>
		<para><emphasis role="bold">General Settings</emphasis></para>
		<para>In <literal>Tools</literal> section we found the option <literal>General Settings</literal> from which the user can establish the configuration of the general parameters of the Manager.</para>
		<para>This is the highest level of configuration (<emphasis role="bold">root</emphasis> domain) so the properties defined here will be inherited by the rest of the domains and sensors that are below this level.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img063.png"/>
			</imageobject>
			<caption>
				<para>General Settings: General Manager configuration or "root"</para>
	 		</caption>
		</mediaobject>
		<para><emphasis role="bold">Inherited setting: "Inherited"</emphasis></para>	
		<para>When a domain or sensor is created or edited for the first time, we will notice that some parameters are accompanied by the label 
		<emphasis role="bold">"Inherited"</emphasis>, this means that they have inherited the values ââinherited from the general configuration of the Manager
or of the domains or sensors that are above the newly created element.
To change this setting, the user will need to override that information.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch03_img064.png"/>
			</imageobject>
			<caption>
				<para>Inherited IPS/IDS sensor configuration</para>
	 		</caption>
		</mediaobject>
    </section>	
</chapter>		